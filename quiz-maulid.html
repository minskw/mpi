<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎮 QUIZ SHOW MAULID NABI 🎮</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Nunito:wght@400;600;700;800;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(45deg, #2c5aa0 0%, #1e3c72 25%, #2193b0 50%, #6dd5ed 75%, #00c9ff 100%);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
            min-height: 100vh;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes zoomIn {
            from {
                opacity: 0;
                transform: scale(0.5);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes confetti {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* TV Show Header */
        .tv-header {
            text-align: center;
            margin-bottom: 30px;
            animation: slideInDown 1s ease-out;
        }

        .show-logo {
            font-family: 'Fredoka One', cursive;
            font-size: 4rem;
            background: linear-gradient(45deg, #00d4aa, #007cf0, #0099f7, #00c9ff, #7928ca);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 3s ease infinite, bounce 2s ease-in-out infinite;
            text-shadow: 0 0 30px rgba(255,255,255,0.5);
            margin-bottom: 10px;
        }

        .show-subtitle {
            font-size: 1.8rem;
            color: white;
            font-weight: 800;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
            background: rgba(255,255,255,0.2);
            padding: 15px 30px;
            border-radius: 50px;
            display: inline-block;
            backdrop-filter: blur(10px);
            border: 3px solid rgba(255,255,255,0.3);
        }

        /* Live Scoreboard - Game Show Style */
        .scoreboard {
            background: linear-gradient(135deg, rgba(0,0,0,0.8), rgba(0,0,0,0.6));
            border-radius: 25px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            backdrop-filter: blur(20px);
            border: 4px solid rgba(255,255,255,0.2);
            animation: slideInUp 1s ease-out;
        }

        .scoreboard-header {
            text-align: center;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #007cf0, #00d4aa);
            color: white;
            padding: 20px;
            border-radius: 20px;
            font-family: 'Fredoka One', cursive;
            font-size: 1.5rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            animation: pulse 2s ease-in-out infinite;
        }

        .current-player {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #2c3e50;
            padding: 15px 25px;
            border-radius: 50px;
            font-weight: 900;
            font-size: 1.3rem;
            display: inline-block;
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.4);
            animation: pulse 1.5s ease-in-out infinite;
            border: 3px solid #fff;
        }

        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .score-card {
            background: linear-gradient(135deg, #2193b0, #1e3c72);
            color: white;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 15px 35px rgba(33, 147, 176, 0.4);
            border: 4px solid rgba(255,255,255,0.2);
            position: relative;
            overflow: hidden;
        }

        .score-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.6s;
            opacity: 0;
        }

        .score-card:hover::before {
            animation: shine 0.6s ease-in-out;
            opacity: 1;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .score-card.active {
            background: linear-gradient(135deg, #00c9ff, #007cf0);
            transform: scale(1.1);
            box-shadow: 0 20px 50px rgba(0, 201, 255, 0.6);
            border: 4px solid #ffd700;
            animation: pulse 1s ease-in-out infinite;
        }

        .score-card.active::after {
            content: '👑';
            position: absolute;
            top: -10px;
            right: -5px;
            font-size: 2.5rem;
            animation: bounce 1s ease-in-out infinite;
        }

        .team-name {
            font-size: 1.1rem;
            font-weight: 800;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .team-score {
            font-size: 2.5rem;
            font-weight: 900;
            font-family: 'Fredoka One', cursive;
        }

        .team-correct {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 5px;
        }

        /* Setup Screen - Game Show Style */
        .setup-screen {
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.85));
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 50px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.2);
            border: 4px solid rgba(255,255,255,0.3);
            animation: zoomIn 0.8s ease-out;
        }

        .setup-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .setup-icon {
            font-size: 5rem;
            margin-bottom: 20px;
            animation: bounce 2s ease-in-out infinite;
        }

        .setup-title {
            font-family: 'Fredoka One', cursive;
            font-size: 3rem;
            background: linear-gradient(45deg, #2193b0, #007cf0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }

        .setup-description {
            font-size: 1.3rem;
            color: #7f8c8d;
            font-weight: 700;
        }

        .game-show-btn {
            background: linear-gradient(45deg, #007cf0, #00c9ff);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 50px;
            font-size: 1.4rem;
            font-weight: 800;
            font-family: 'Fredoka One', cursive;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 15px 35px rgba(0, 124, 240, 0.4);
            border: 4px solid rgba(255,255,255,0.3);
            text-transform: uppercase;
            letter-spacing: 2px;
            position: relative;
            overflow: hidden;
        }

        .game-show-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .game-show-btn:hover::before {
            left: 100%;
        }

        .game-show-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 25px 50px rgba(0, 124, 240, 0.6);
        }

        .game-show-btn.secondary {
            background: linear-gradient(45deg, #00d4aa, #2193b0);
            box-shadow: 0 15px 35px rgba(0, 212, 170, 0.4);
        }

        .game-show-btn.secondary:hover {
            box-shadow: 0 25px 50px rgba(0, 212, 170, 0.6);
        }

        /* Question Display - TV Style */
        .question-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            animation: slideInUp 0.8s ease-out;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 30px 50px;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
        }

        .question-info {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .question-badge {
            background: linear-gradient(45deg, #2193b0, #1e3c72);
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 800;
            font-size: 1.2rem;
            font-family: 'Fredoka One', cursive;
            box-shadow: 0 10px 30px rgba(33, 147, 176, 0.4);
            border: 3px solid rgba(255,255,255,0.3);
        }

        .timer-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, #007cf0, #00c9ff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 900;
            color: white;
            font-family: 'Fredoka One', cursive;
            box-shadow: 0 15px 35px rgba(0, 124, 240, 0.6);
            border: 4px solid rgba(255,255,255,0.3);
            animation: pulse 1s ease-in-out infinite;
        }

        .timer-circle.warning {
            background: linear-gradient(45deg, #ff4757, #ff3742);
            animation: shake 0.5s ease-in-out infinite;
        }

        .question-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 50px;
            text-align: center;
        }

        .question-text {
            font-size: 3.5rem;
            font-weight: 900;
            color: white;
            text-shadow: 0 6px 12px rgba(0,0,0,0.4);
            margin-bottom: 60px;
            line-height: 1.2;
            font-family: 'Fredoka One', cursive;
            animation: slideInDown 1s ease-out 0.3s both;
        }

        .answers-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .answer-btn {
            border: none;
            padding: 40px 30px;
            border-radius: 25px;
            font-size: 1.8rem;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-align: left;
            color: white;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            min-height: 160px;
            display: flex;
            align-items: center;
            gap: 25px;
            position: relative;
            overflow: hidden;
            animation: slideInUp 0.8s ease-out;
        }

        .answer-btn:nth-child(1) {
            background: linear-gradient(135deg, #007cf0, #0099f7);
            animation-delay: 0.1s;
        }

        .answer-btn:nth-child(2) {
            background: linear-gradient(135deg, #00d4aa, #2193b0);
            animation-delay: 0.2s;
        }

        .answer-btn:nth-child(3) {
            background: linear-gradient(135deg, #00c9ff, #6dd5ed);
            animation-delay: 0.3s;
        }

        .answer-btn:nth-child(4) {
            background: linear-gradient(135deg, #1e3c72, #2c5aa0);
            animation-delay: 0.4s;
        }

        .answer-letter {
            background: rgba(255,255,255,0.3);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.2rem;
            font-weight: 900;
            font-family: 'Fredoka One', cursive;
            flex-shrink: 0;
            border: 4px solid rgba(255,255,255,0.5);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .answer-text {
            flex: 1;
            line-height: 1.4;
            font-family: 'Nunito', sans-serif;
        }

        .answer-btn:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 60px rgba(0,0,0,0.3);
        }

        .answer-btn.correct {
            background: linear-gradient(135deg, #2ecc71, #27ae60) !important;
            border: 6px solid #fff !important;
            animation: pulse 0.6s ease-in-out 3;
        }

        .answer-btn.correct::after {
            content: '✅';
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 3rem;
            animation: bounce 0.6s ease-in-out;
        }

        .answer-btn.wrong {
            background: linear-gradient(135deg, #e74c3c, #c0392b) !important;
            border: 6px solid #fff !important;
            animation: shake 0.6s ease-in-out 2;
        }

        .answer-btn.wrong::after {
            content: '❌';
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 3rem;
            animation: shake 0.6s ease-in-out;
        }

        /* Result Screen - Award Show Style */
        .result-screen {
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,255,255,0.9));
            border-radius: 30px;
            padding: 60px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.2);
            text-align: center;
            backdrop-filter: blur(20px);
            border: 4px solid rgba(255,255,255,0.3);
            animation: zoomIn 1s ease-out;
        }

        .winner-celebration {
            margin-bottom: 40px;
        }

        .winner-icon {
            font-size: 8rem;
            margin-bottom: 30px;
            animation: bounce 2s ease-in-out infinite;
        }

        .winner-title {
            font-family: 'Fredoka One', cursive;
            font-size: 4.5rem;
            background: linear-gradient(45deg, #ffd700, #00d4aa, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            text-shadow: 0 4px 8px rgba(0,0,0,0.1);
            animation: pulse 2s ease-in-out infinite;
        }

        .winner-subtitle {
            font-size: 1.8rem;
            color: #7f8c8d;
            font-weight: 700;
            margin-bottom: 50px;
        }

        .podium-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin: 50px 0;
        }

        .podium-card {
            padding: 40px 30px;
            border-radius: 25px;
            color: white;
            font-weight: 800;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            animation: slideInUp 1s ease-out;
        }

        .podium-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shine 3s ease-in-out infinite;
        }

        .podium-card.first {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #2c3e50;
            transform: scale(1.1);
            box-shadow: 0 25px 60px rgba(255, 215, 0, 0.4);
            animation-delay: 0.1s;
        }

        .podium-card.second {
            background: linear-gradient(135deg, #c0c0c0, #a8a8a8);
            animation-delay: 0.2s;
        }

        .podium-card.third {
            background: linear-gradient(135deg, #cd7f32, #b8860b);
            animation-delay: 0.3s;
        }

        .podium-position {
            font-size: 1.6rem;
            font-weight: 900;
            margin-bottom: 15px;
            font-family: 'Fredoka One', cursive;
        }

        .podium-team {
            font-size: 2.2rem;
            font-weight: 900;
            margin-bottom: 20px;
            font-family: 'Fredoka One', cursive;
        }

        .podium-score {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 15px;
            font-family: 'Fredoka One', cursive;
        }

        .podium-stats {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Confetti Animation */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #ffd700;
            animation: confetti 3s linear infinite;
            z-index: 9999;
        }

        .confetti:nth-child(odd) {
            background: #ff6b6b;
            animation-delay: -0.5s;
        }

        .confetti:nth-child(3n) {
            background: #4ecdc4;
            animation-delay: -1s;
        }

        .confetti:nth-child(4n) {
            background: #a8e6cf;
            animation-delay: -1.5s;
        }

        /* Success/Error Messages */
        .game-message {
            position: fixed;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            font-weight: 900;
            z-index: 10001;
            pointer-events: none;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
            font-family: 'Fredoka One', cursive;
            animation: zoomIn 0.5s ease-out;
        }

        .game-message.correct {
            color: #2ecc71;
        }

        .game-message.wrong {
            color: #e74c3c;
        }

        .game-message.timeout {
            color: #ff4757;
        }

        /* Hidden class */
        .hidden {
            display: none !important;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .show-logo {
                font-size: 2.5rem;
            }
            
            .question-text {
                font-size: 2.2rem;
            }
            
            .answers-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .answer-btn {
                padding: 25px 20px;
                font-size: 1.4rem;
                min-height: 120px;
            }
            
            .setup-screen, .result-screen {
                padding: 30px 20px;
            }

            .score-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
            }

            .podium-container {
                grid-template-columns: 1fr;
            }
        }

        /* Team Setup Styles */
        .team-setup-section {
            margin: 30px 0;
        }

        .section-title {
            font-family: 'Fredoka One', cursive;
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
        }

        .team-count-selector {
            background: linear-gradient(45deg, #2193b0, #1e3c72);
            color: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            box-shadow: 0 10px 30px rgba(33, 147, 176, 0.3);
        }

        .team-count-selector label {
            font-size: 1.3rem;
            font-weight: 800;
            font-family: 'Fredoka One', cursive;
        }

        .team-count-selector select {
            padding: 12px 20px;
            font-size: 1.1rem;
            border: none;
            border-radius: 15px;
            background: white;
            font-weight: 800;
            cursor: pointer;
            color: #2c3e50;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            font-family: 'Nunito', sans-serif;
        }

        .teams-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .team-card {
            background: linear-gradient(135deg, #00d4aa, #2193b0);
            color: white;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0, 212, 170, 0.4);
            transition: all 0.3s ease;
            border: 4px solid rgba(255,255,255,0.2);
        }

        .team-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 45px rgba(0, 212, 170, 0.6);
        }

        .team-card h3 {
            font-family: 'Fredoka One', cursive;
            font-size: 1.4rem;
            margin-bottom: 15px;
        }

        .team-input {
            width: 100%;
            padding: 12px 15px;
            border: none;
            border-radius: 15px;
            font-size: 1rem;
            text-align: center;
            font-weight: 700;
            background: rgba(255,255,255,0.95);
            color: #2c3e50;
            font-family: 'Nunito', sans-serif;
        }

        .team-input:focus {
            outline: none;
            box-shadow: 0 0 0 4px rgba(255,255,255,0.5);
        }

        /* Import Section */
        .import-section {
            background: rgba(255,255,255,0.8);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 3px dashed #ddd;
            text-align: center;
        }

        .import-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .file-input {
            display: none;
        }

        .import-info {
            font-size: 0.95rem;
            color: #7f8c8d;
            font-weight: 600;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- TV Show Header -->
        <div class="tv-header">
            <h1 class="show-logo">🎮 QUIZ SHOW MAULID NABI 🎮</h1>
            <p class="show-subtitle">🕌 Peringatan Maulid Nabi Muhammad SAW 🕌</p>
            
            <!-- Live Scoreboard -->
            <div class="scoreboard hidden" id="scoreboard">
                <div class="scoreboard-header">
                    🏆 PAPAN SKOR LIVE 🏆
                    <div style="margin-top: 10px;">
                        <span style="font-size: 1.2rem;">GILIRAN:</span>
                        <div class="current-player" id="currentPlayerIndicator">Tim 1</div>
                    </div>
                </div>
                <div class="score-grid" id="scoreGrid">
                    <!-- Live scores will be populated here -->
                </div>
            </div>
        </div>

        <!-- Setup Screen -->
        <div id="setupScreen" class="setup-screen">
            <div class="setup-header">
                <div class="setup-icon">🎯</div>
                <h2 class="setup-title">PERSIAPAN QUIZ SHOW</h2>
                <p class="setup-description">Siapkan tim dan mulai petualangan quiz yang seru!</p>
            </div>

            <!-- Import Section -->
            <div class="import-section">
                <div class="section-title">📚 Import Soal Quiz</div>
                <div class="import-buttons">
                    <button class="game-show-btn secondary" onclick="downloadTemplate()">
                        📥 Download Template Excel
                    </button>
                    <label for="excelFile" class="game-show-btn">
                        📤 Import Soal Excel
                        <input type="file" id="excelFile" class="file-input" accept=".xlsx,.xls" onchange="importExcel(event)">
                    </label>
                </div>
                <div class="import-info">
                    <strong>Format Excel:</strong> Kolom A=Pertanyaan, B=Jawaban A, C=Jawaban B, D=Jawaban C, E=Jawaban D, F=Jawaban Benar (A/B/C/D), G=Kategori, H=Poin
                </div>
            </div>

            <!-- Team Setup -->
            <div class="team-setup-section">
                <div class="section-title">👥 Setup Tim Peserta</div>
                
                <div class="team-count-selector">
                    <label>🎪 Jumlah Tim:</label>
                    <select id="teamCount" onchange="updateTeamSetup()">
                        <option value="3">3 Tim</option>
                        <option value="4">4 Tim</option>
                        <option value="5" selected>5 Tim</option>
                        <option value="6">6 Tim</option>
                        <option value="7">7 Tim</option>
                        <option value="8">8 Tim</option>
                    </select>
                </div>

                <div class="teams-grid" id="teamsGrid">
                    <!-- Team inputs will be generated here -->
                </div>
            </div>

            <div style="display: flex; gap: 25px; justify-content: center; flex-wrap: wrap; margin-top: 40px;">
                <button class="game-show-btn" onclick="startQuizShow()" id="startBtn">
                    🚀 MULAI QUIZ SHOW!
                </button>
                <button class="game-show-btn secondary" onclick="clearSavedGame()">
                    🗑️ Reset Data
                </button>
            </div>
        </div>

        <!-- Game Screen (Hidden initially) -->
        <div id="gameScreen" class="hidden">
            <!-- Questions will be displayed in full-screen popup -->
        </div>

        <!-- Result Screen -->
        <div id="resultScreen" class="result-screen hidden">
            <div class="winner-celebration">
                <div class="winner-icon">🏆</div>
                <h2 class="winner-title" id="winnerTitle">SELAMAT JUARA!</h2>
                <p class="winner-subtitle">Quiz Show telah selesai dengan meriah!</p>
            </div>
            
            <div class="podium-container" id="podiumContainer">
                <!-- Podium will be populated here -->
            </div>

            <div style="margin: 50px 0; font-size: 1.4rem; color: #7f8c8d; font-weight: 700; line-height: 1.6;">
                <p>🌟 Semoga ilmu yang telah dipelajari bermanfaat</p>
                <p>dan menjadi amal jariyah bagi kita semua 🌟</p>
                <p style="margin-top: 25px; font-weight: 900; color: #2c3e50; font-size: 1.6rem;" class="arabic-text">بارك الله فيكم</p>
            </div>

            <button class="game-show-btn" onclick="restartQuizShow()">
                🔄 QUIZ SHOW BARU
            </button>
        </div>
    </div>

    <!-- Include SheetJS for Excel processing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        // Game state variables
        let currentQuestion = 0;
        let timeLeft = 30;
        let timer;
        let gameActive = false;
        let teams = [];
        let currentTeam = 0;
        let questionAnswered = false;
        let answeredQuestions = new Set();
        let selectedQuestion = null;
        let importedQuestions = [];
        let gameQuestions = [];

        // Default team names with fun emojis
        const defaultTeamNames = [
            '🌟 Tim Sahabat', '⭐ Tim Tabi\'in', '✨ Tim Salafus Shalih', 
            '🎯 Tim Muhajirin', '🏆 Tim Anshar', '👑 Tim Khulafaur Rasyidin', 
            '💫 Tim Ahlul Bayt', '🌙 Tim Ulama'
        ];

        // Default Islamic knowledge questions
        let defaultQuestions = [
            // Sejarah
            {
                question: "Siapa nama ayah Nabi Muhammad SAW?",
                answers: ["Abdullah", "Abu Thalib", "Abdul Muthalib", "Abu Bakar"],
                correct: 0,
                category: "Sejarah",
                points: 100
            },
            {
                question: "Di kota mana Nabi Muhammad SAW dilahirkan?",
                answers: ["Madinah", "Makkah", "Thaif", "Yaman"],
                correct: 1,
                category: "Sejarah",
                points: 200
            },
            {
                question: "Siapa nama ibu Nabi Muhammad SAW?",
                answers: ["Khadijah", "Aisyah", "Aminah", "Fatimah"],
                correct: 2,
                category: "Sejarah",
                points: 300
            },
            {
                question: "Pada usia berapa Nabi Muhammad SAW diangkat menjadi Rasul?",
                answers: ["35 tahun", "40 tahun", "45 tahun", "50 tahun"],
                correct: 1,
                category: "Sejarah",
                points: 400
            },
            {
                question: "Siapa sahabat pertama yang masuk Islam?",
                answers: ["Umar bin Khattab", "Utsman bin Affan", "Ali bin Abi Thalib", "Abu Bakar Ash-Shiddiq"],
                correct: 3,
                category: "Sejarah",
                points: 500
            },

            // Quran Hadis
            {
                question: "Berapa jumlah surat dalam Al-Qur'an?",
                answers: ["112", "113", "114", "115"],
                correct: 2,
                category: "Quran Hadis",
                points: 100
            },
            {
                question: "Apa nama surat pertama dalam Al-Qur'an?",
                answers: ["Al-Baqarah", "Al-Fatihah", "An-Nas", "Al-Falaq"],
                correct: 1,
                category: "Quran Hadis",
                points: 200
            },
            {
                question: "Surat Al-Fatihah terdiri dari berapa ayat?",
                answers: ["5 ayat", "6 ayat", "7 ayat", "8 ayat"],
                correct: 2,
                category: "Quran Hadis",
                points: 300
            },
            {
                question: "Siapa yang paling banyak meriwayatkan hadits?",
                answers: ["Abu Bakar", "Umar bin Khattab", "Abu Hurairah", "Ali bin Abi Thalib"],
                correct: 2,
                category: "Quran Hadis",
                points: 400
            },
            {
                question: "Apa arti kata 'hadits'?",
                answers: ["Cerita", "Berita", "Kisah", "Semua benar"],
                correct: 3,
                category: "Quran Hadis",
                points: 500
            },

            // Akidah Akhlak
            {
                question: "Berapa jumlah rukun iman?",
                answers: ["5", "6", "7", "8"],
                correct: 1,
                category: "Akidah Akhlak",
                points: 100
            },
            {
                question: "Rukun iman yang pertama adalah?",
                answers: ["Iman kepada Allah", "Iman kepada Malaikat", "Iman kepada Kitab", "Iman kepada Rasul"],
                correct: 0,
                category: "Akidah Akhlak",
                points: 200
            },
            {
                question: "Berapa nama Allah yang termasuk Asmaul Husna?",
                answers: ["90", "95", "99", "100"],
                correct: 2,
                category: "Akidah Akhlak",
                points: 300
            },
            {
                question: "Apa sifat terpuji yang harus dimiliki seorang Muslim?",
                answers: ["Sombong", "Jujur", "Marah", "Iri"],
                correct: 1,
                category: "Akidah Akhlak",
                points: 400
            },
            {
                question: "Bagaimana cara berbakti kepada orang tua?",
                answers: ["Membantah", "Menuruti semua keinginan", "Berbuat baik dan patuh", "Mengabaikan"],
                correct: 2,
                category: "Akidah Akhlak",
                points: 500
            },

            // Fikih
            {
                question: "Berapa kali shalat wajib dalam sehari?",
                answers: ["3 kali", "4 kali", "5 kali", "6 kali"],
                correct: 2,
                category: "Fikih",
                points: 100
            },
            {
                question: "Apa shalat yang dikerjakan setelah Maghrib?",
                answers: ["Ashar", "Maghrib", "Isya", "Subuh"],
                correct: 2,
                category: "Fikih",
                points: 200
            },
            {
                question: "Berapa rakaat shalat Subuh?",
                answers: ["2 rakaat", "3 rakaat", "4 rakaat", "5 rakaat"],
                correct: 0,
                category: "Fikih",
                points: 300
            },
            {
                question: "Apa yang membatalkan wudhu?",
                answers: ["Makan", "Minum", "Buang air kecil", "Berbicara"],
                correct: 2,
                category: "Fikih",
                points: 400
            },
            {
                question: "Apa rukun Islam yang pertama?",
                answers: ["Shalat", "Syahadat", "Zakat", "Puasa"],
                correct: 1,
                category: "Fikih",
                points: 500
            },

            // Bahasa Arab
            {
                question: "Apa arti kata 'Bismillah'?",
                answers: ["Dengan nama Allah", "Alhamdulillah", "Subhanallah", "Allahu Akbar"],
                correct: 0,
                category: "Bahasa Arab",
                points: 100
            },
            {
                question: "Apa arti kata 'Assalamu'alaikum'?",
                answers: ["Selamat pagi", "Selamat siang", "Semoga keselamatan atasmu", "Terima kasih"],
                correct: 2,
                category: "Bahasa Arab",
                points: 200
            },
            {
                question: "Apa arti kata 'Barakallahu fiik'?",
                answers: ["Semoga Allah memberkahimu", "Terima kasih", "Maaf", "Selamat"],
                correct: 0,
                category: "Bahasa Arab",
                points: 300
            },
            {
                question: "Apa arti kata 'Jazakallahu khairan'?",
                answers: ["Selamat pagi", "Semoga Allah membalasmu dengan kebaikan", "Maaf", "Sampai jumpa"],
                correct: 1,
                category: "Bahasa Arab",
                points: 400
            },
            {
                question: "Apa arti kata 'Astaghfirullah'?",
                answers: ["Alhamdulillah", "Aku memohon ampun kepada Allah", "Subhanallah", "Allahu Akbar"],
                correct: 1,
                category: "Bahasa Arab",
                points: 500
            }
        ];

        // Download Excel template
        function downloadTemplate() {
            const templateData = [
                ['Pertanyaan', 'Jawaban A', 'Jawaban B', 'Jawaban C', 'Jawaban D', 'Jawaban Benar', 'Kategori', 'Poin'],
                ['Siapa nama ayah Nabi Muhammad SAW?', 'Abdullah', 'Abu Thalib', 'Abdul Muthalib', 'Abu Bakar', 'A', 'Sejarah', '100'],
                ['Di kota mana Nabi Muhammad SAW dilahirkan?', 'Madinah', 'Makkah', 'Thaif', 'Yaman', 'B', 'Sejarah', '200'],
                ['Berapa jumlah surat dalam Al-Qur\'an?', '112', '113', '114', '115', 'C', 'Quran Hadis', '300'],
                ['Berapa jumlah rukun iman?', '5', '6', '7', '8', 'B', 'Akidah Akhlak', '400'],
                ['Berapa kali shalat wajib dalam sehari?', '3 kali', '4 kali', '5 kali', '6 kali', 'C', 'Fikih', '500']
            ];

            const ws = XLSX.utils.aoa_to_sheet(templateData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Template Soal Quiz');
            
            // Set column widths
            ws['!cols'] = [
                {wch: 50}, {wch: 20}, {wch: 20}, {wch: 20}, {wch: 20}, {wch: 15}, {wch: 15}, {wch: 10}
            ];

            XLSX.writeFile(wb, 'Template_Soal_Quiz_Show_Maulid.xlsx');
        }

        // Import Excel file
        function importExcel(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});

                    // Skip header row
                    const questionsData = jsonData.slice(1);
                    importedQuestions = [];

                    questionsData.forEach((row, index) => {
                        if (row.length >= 7 && row[0]) {
                            const correctAnswerLetter = row[5]?.toString().toUpperCase();
                            let correctIndex = 0;
                            
                            switch(correctAnswerLetter) {
                                case 'A': correctIndex = 0; break;
                                case 'B': correctIndex = 1; break;
                                case 'C': correctIndex = 2; break;
                                case 'D': correctIndex = 3; break;
                                default: correctIndex = 0;
                            }

                            importedQuestions.push({
                                question: row[0],
                                answers: [row[1], row[2], row[3], row[4]],
                                correct: correctIndex,
                                category: row[6] || 'Umum',
                                points: parseInt(row[7]) || 100
                            });
                        }
                    });

                    if (importedQuestions.length > 0) {
                        // Count questions by category
                        const categoryCount = {};
                        importedQuestions.forEach(q => {
                            categoryCount[q.category] = (categoryCount[q.category] || 0) + 1;
                        });
                        
                        let countInfo = Object.entries(categoryCount)
                            .map(([cat, count]) => `${cat}: ${count} soal`)
                            .join('\n');
                        
                        showGameMessage(`✅ Berhasil import ${importedQuestions.length} soal!\n\nRincian per kategori:\n${countInfo}`, 'correct');
                    } else {
                        showGameMessage('❌ Tidak ada soal valid yang ditemukan. Periksa format Excel Anda.', 'wrong');
                    }

                } catch (error) {
                    showGameMessage('❌ Error membaca file Excel. Pastikan format file benar.', 'wrong');
                    console.error('Excel import error:', error);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        // Update team setup
        function updateTeamSetup() {
            const teamCount = parseInt(document.getElementById('teamCount').value);
            const teamsGrid = document.getElementById('teamsGrid');
            teamsGrid.innerHTML = '';

            const teamEmojis = ['🥇', '🥈', '🥉', '🏅', '⭐', '🌟', '✨', '💫'];

            for (let i = 0; i < teamCount; i++) {
                const teamCard = document.createElement('div');
                teamCard.className = 'team-card';
                teamCard.style.animationDelay = `${i * 0.1}s`;
                teamCard.innerHTML = `
                    <h3>${teamEmojis[i]} Tim ${i + 1}</h3>
                    <input type="text" class="team-input" id="team${i + 1}Name" 
                           placeholder="Nama Tim ${i + 1}" value="${defaultTeamNames[i]}">
                `;
                teamsGrid.appendChild(teamCard);
            }
        }

        // Initialize teams
        function initializeTeams() {
            const teamCount = parseInt(document.getElementById('teamCount').value);
            teams = [];
            
            for (let i = 0; i < teamCount; i++) {
                const teamName = document.getElementById(`team${i + 1}Name`).value || `Tim ${i + 1}`;
                teams.push({ name: teamName, score: 0, correct: 0 });
            }
        }

        // Prepare questions for the game
        function prepareGameQuestions() {
            const questionsToUse = importedQuestions.length > 0 ? importedQuestions : defaultQuestions;
            
            // Shuffle questions and take up to 20 for the game
            gameQuestions = [...questionsToUse];
            shuffleArray(gameQuestions);
            gameQuestions = gameQuestions.slice(0, Math.min(20, gameQuestions.length));
            
            // Shuffle answers for each question
            gameQuestions.forEach(q => shuffleAnswers(q));
        }

        // Start Quiz Show
        function startQuizShow() {
            if (importedQuestions.length === 0 && defaultQuestions.length < 5) {
                showGameMessage('❌ Minimal 5 soal diperlukan untuk memulai quiz show!', 'wrong');
                return;
            }

            initializeTeams();
            prepareGameQuestions();
            
            // Hide setup screen and show scoreboard
            document.getElementById('setupScreen').classList.add('hidden');
            document.getElementById('scoreboard').classList.remove('hidden');
            
            currentQuestion = 0;
            currentTeam = 0;
            gameActive = true;
            answeredQuestions.clear();
            
            updateScoreboard();
            
            // Show welcome message and start first question
            showGameMessage('🎉 QUIZ SHOW DIMULAI! 🎉', 'correct');
            setTimeout(() => {
                nextQuestion();
            }, 2000);
        }

        // Next question
        function nextQuestion() {
            if (currentQuestion >= gameQuestions.length) {
                endQuizShow();
                return;
            }

            showQuestionScreen();
        }

        // Show question screen
        function showQuestionScreen() {
            const question = gameQuestions[currentQuestion];
            
            const questionScreen = document.createElement('div');
            questionScreen.className = 'question-screen';
            questionScreen.id = 'questionScreen';
            
            questionScreen.innerHTML = `
                <div class="question-header">
                    <div class="question-info">
                        <div class="question-badge">Soal ${currentQuestion + 1}/${gameQuestions.length}</div>
                        <div class="question-badge">${question.category}</div>
                        <div class="question-badge">${question.points} Poin</div>
                    </div>
                    <div class="timer-circle" id="timerCircle">30</div>
                </div>
                
                <div class="question-content">
                    <div class="question-text">${question.question}</div>
                    
                    <div class="answers-grid" id="answersGrid">
                        <!-- Answers will be populated here -->
                    </div>
                </div>
            `;
            
            document.body.appendChild(questionScreen);
            
            // Populate answers
            const answersGrid = document.getElementById('answersGrid');
            question.answers.forEach((answer, index) => {
                const button = document.createElement('button');
                button.className = 'answer-btn';
                button.innerHTML = `
                    <div class="answer-letter">${String.fromCharCode(65 + index)}</div>
                    <div class="answer-text">${answer}</div>
                `;
                button.onclick = () => selectAnswer(index);
                answersGrid.appendChild(button);
            });

            // Start timer
            timeLeft = 30;
            gameActive = true;
            questionAnswered = false;
            startTimer();
        }

        // Select answer
        function selectAnswer(selectedIndex) {
            if (!gameActive || questionAnswered) return;

            questionAnswered = true;
            clearInterval(timer);
            
            const question = gameQuestions[currentQuestion];
            const buttons = document.querySelectorAll('.answer-btn');
            
            // Disable all buttons
            buttons.forEach(btn => btn.style.pointerEvents = 'none');
            
            if (selectedIndex === question.correct) {
                buttons[selectedIndex].classList.add('correct');
                teams[currentTeam].score += question.points;
                teams[currentTeam].correct++;
                
                showGameMessage('🎉 BENAR! 🎉', 'correct');
                createConfetti();
                
                setTimeout(() => closeQuestionScreen(), 2000);
            } else {
                buttons[selectedIndex].classList.add('wrong');
                
                showGameMessage('❌ SALAH!', 'wrong');
                
                setTimeout(() => {
                    buttons[question.correct].classList.add('correct');
                }, 800);
                
                setTimeout(() => closeQuestionScreen(), 3000);
            }

            updateScoreboard();
        }

        // Close question screen
        function closeQuestionScreen() {
            const questionScreen = document.getElementById('questionScreen');
            if (questionScreen) questionScreen.remove();
            
            // Move to next team
            currentTeam = (currentTeam + 1) % teams.length;
            
            // If all teams have answered, move to next question
            if (currentTeam === 0) {
                currentQuestion++;
            }
            
            updateScoreboard();
            
            // Continue to next question or end game
            setTimeout(() => {
                nextQuestion();
            }, 1000);
        }

        // Start timer
        function startTimer() {
            timer = setInterval(() => {
                timeLeft--;
                const timerCircle = document.getElementById('timerCircle');
                if (timerCircle) {
                    timerCircle.textContent = timeLeft;
                    
                    if (timeLeft <= 10) {
                        timerCircle.classList.add('warning');
                    }
                }
                
                if (timeLeft <= 0) {
                    if (!questionAnswered) {
                        questionAnswered = true;
                        const question = gameQuestions[currentQuestion];
                        const buttons = document.querySelectorAll('.answer-btn');
                        buttons.forEach(btn => btn.style.pointerEvents = 'none');
                        buttons[question.correct].classList.add('correct');
                        
                        showGameMessage('⏰ WAKTU HABIS!', 'timeout');
                        
                        setTimeout(() => closeQuestionScreen(), 2500);
                    }
                    clearInterval(timer);
                }
            }, 1000);
        }

        // Update scoreboard
        function updateScoreboard() {
            const scoreGrid = document.getElementById('scoreGrid');
            const playerIndicator = document.getElementById('currentPlayerIndicator');
            
            scoreGrid.innerHTML = '';
            
            // Update current player indicator
            if (playerIndicator && teams.length > 0) {
                playerIndicator.textContent = teams[currentTeam]?.name || `Tim ${currentTeam + 1}`;
            }
            
            teams.forEach((team, index) => {
                const scoreCard = document.createElement('div');
                scoreCard.className = `score-card ${index === currentTeam ? 'active' : ''}`;
                scoreCard.innerHTML = `
                    <div class="team-name">${team.name}</div>
                    <div class="team-score">${team.score}</div>
                    <div class="team-correct">Benar: ${team.correct}</div>
                `;
                scoreGrid.appendChild(scoreCard);
            });
        }

        // End Quiz Show
        function endQuizShow() {
            gameActive = false;
            
            document.getElementById('scoreboard').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
            
            const sortedTeams = [...teams].sort((a, b) => b.score - a.score);
            
            document.getElementById('winnerTitle').textContent = `🏆 ${sortedTeams[0].name} JUARA! 🏆`;
            
            const podiumContainer = document.getElementById('podiumContainer');
            podiumContainer.innerHTML = '';
            
            const positions = ['first', 'second', 'third'];
            const positionNames = ['🥇 JUARA 1', '🥈 JUARA 2', '🥉 JUARA 3'];
            
            sortedTeams.slice(0, 3).forEach((team, index) => {
                const podiumCard = document.createElement('div');
                podiumCard.className = `podium-card ${positions[index]}`;
                podiumCard.innerHTML = `
                    <div class="podium-position">${positionNames[index]}</div>
                    <div class="podium-team">${team.name}</div>
                    <div class="podium-score">${team.score}</div>
                    <div class="podium-stats">Benar: ${team.correct}/${gameQuestions.length}</div>
                `;
                podiumContainer.appendChild(podiumCard);
            });

            // Create celebration confetti
            createConfetti();
        }

        // Restart Quiz Show
        function restartQuizShow() {
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('setupScreen').classList.remove('hidden');
            
            // Reset game state
            currentQuestion = 0;
            currentTeam = 0;
            teams = [];
            answeredQuestions.clear();
            selectedQuestion = null;
            gameActive = false;
            gameQuestions = [];
            
            // Reset file input
            document.getElementById('excelFile').value = '';
            
            // Update team setup
            updateTeamSetup();
        }

        // Clear saved game
        function clearSavedGame() {
            if (confirm('⚠️ Yakin ingin menghapus semua data quiz yang tersimpan?')) {
                // Reset all data
                currentQuestion = 0;
                currentTeam = 0;
                teams = [];
                answeredQuestions.clear();
                selectedQuestion = null;
                importedQuestions = [];
                gameActive = false;
                gameQuestions = [];
                
                // Reset file input
                document.getElementById('excelFile').value = '';
                
                showGameMessage('🗑️ Data berhasil dihapus!', 'correct');
            }
        }

        // Show game message
        function showGameMessage(message, type) {
            const messageEl = document.createElement('div');
            messageEl.className = `game-message ${type}`;
            messageEl.innerHTML = message;
            document.body.appendChild(messageEl);
            
            setTimeout(() => {
                if (messageEl.parentNode) {
                    messageEl.remove();
                }
            }, 3000);
        }

        // Create confetti effect
        function createConfetti() {
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.animationDelay = Math.random() * 3 + 's';
                    confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        if (confetti.parentNode) {
                            confetti.remove();
                        }
                    }, 5000);
                }, i * 50);
            }
        }

        // Utility functions
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function shuffleAnswers(question) {
            const correctAnswer = question.answers[question.correct];
            shuffleArray(question.answers);
            question.correct = question.answers.indexOf(correctAnswer);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateTeamSetup();
            
            // Show welcome animation
            setTimeout(() => {
                showGameMessage('🎮 Selamat datang di Quiz Show Maulid Nabi! 🎮', 'correct');
            }, 500);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97c6ba38608a3231',t:'MTc1NzQyMTM0Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
