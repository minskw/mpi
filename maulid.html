<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üïå Gebyar Maulid Nabi üïå</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <style>
        .game-font { font-family: 'Fredoka One', cursive; }
        .arabic-font { font-family: 'Amiri', serif; }
        
        @keyframes bounce-in {
            0% { transform: scale(0) rotate(180deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(90deg); opacity: 0.8; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        
        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }
        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
            50% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.8); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0) scale(0.95); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-8px) scale(0.95); }
            20%, 40%, 60%, 80% { transform: translateX(8px) scale(0.95); }
        }
        
        @keyframes score-fly {
            0% { 
                transform: translateY(0) scale(1); 
                opacity: 1; 
            }
            50% { 
                transform: translateY(-50px) scale(1.5); 
                opacity: 0.8; 
            }
            100% { 
                transform: translateY(-100px) scale(0.5); 
                opacity: 0; 
            }
        }
        
        .bounce-in { animation: bounce-in 0.8s ease-out; }
        .rainbow-bg { 
            background: linear-gradient(-45deg, #2d5a27, #4a7c59, #6b8e23, #8fbc8f, #228b22, #32cd32);
            background-size: 400% 400%;
            animation: rainbow 3s ease infinite;
        }
        .float-animation { animation: float 3s ease-in-out infinite; }
        .sparkle { animation: sparkle 2s ease-in-out infinite; }
        .pulse-glow { animation: pulse-glow 2s ease-in-out infinite; }
        .shake { animation: shake 0.8s ease-in-out; }
        .score-fly { animation: score-fly 1.5s ease-out forwards; }
        
        .question-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f39c12;
            animation: confetti-fall 3s linear infinite;
        }
        
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        .game-button {
            background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: bold;
            padding: 12px 24px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .game-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body class="rainbow-bg min-h-screen">
    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <div class="text-center mb-8 bounce-in">
            <h1 class="game-font text-4xl md:text-5xl text-white mb-4 drop-shadow-lg">
                üïå GEBYAR MAULID NABI üïå
            </h1>
            <p class="text-2xl text-white font-bold drop-shadow-md">
                <i class="fas fa-star-and-crescent text-yellow-300"></i> 
                Kompetisi Islami Menyambut Kelahiran Rasulullah Ô∑∫ 
                <i class="fas fa-star-and-crescent text-yellow-300"></i>
            </p>
        </div>

        <!-- Setup Screen -->
        <div id="setup-screen" class="max-w-4xl mx-auto space-y-6">
            <!-- Question Import Section -->
            <div class="bg-white/95 rounded-lg p-6 shadow-lg">
                <h2 class="game-font text-2xl text-center mb-6 text-purple-800">üìö Bank Soal</h2>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h3 class="font-bold mb-3 text-blue-800">üìÅ Upload File Excel</h3>
                        <input type="file" id="question-file" accept=".xlsx,.xls" class="w-full p-3 border rounded-lg mb-3">
                        <div class="space-y-2">
                            <button onclick="importQuestions()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg w-full transition-all">
                                <i class="fas fa-upload mr-2"></i>Import Excel
                            </button>
                            <button onclick="downloadTemplate()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg w-full transition-all">
                                <i class="fas fa-download mr-2"></i>Download Template
                            </button>
                        </div>
                    </div>
                    
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h3 class="font-bold mb-3 text-green-800">‚úèÔ∏è Tambah Manual</h3>
                        <input type="text" id="manual-question" placeholder="Pertanyaan..." class="w-full p-2 border rounded-lg mb-2">
                        <div class="grid grid-cols-2 gap-2 mb-2">
                            <input type="text" id="manual-a" placeholder="Pilihan A" class="p-2 border rounded-lg text-sm">
                            <input type="text" id="manual-b" placeholder="Pilihan B" class="p-2 border rounded-lg text-sm">
                            <input type="text" id="manual-c" placeholder="Pilihan C" class="p-2 border rounded-lg text-sm">
                            <input type="text" id="manual-d" placeholder="Pilihan D" class="p-2 border rounded-lg text-sm">
                        </div>
                        <div class="grid grid-cols-2 gap-2 mb-3">
                            <select id="manual-correct" class="p-2 border rounded-lg text-sm">
                                <option value="">Jawaban benar</option>
                                <option value="a">A</option>
                                <option value="b">B</option>
                                <option value="c">C</option>
                                <option value="d">D</option>
                            </select>
                            <select id="manual-language" class="p-2 border rounded-lg text-sm">
                                <option value="indonesia">Indonesia</option>
                                <option value="arabic">Arab</option>
                                <option value="english">English</option>
                            </select>
                        </div>
                        <button onclick="addManualQuestion()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg w-full transition-all">
                            <i class="fas fa-plus mr-2"></i>Tambah Soal
                        </button>
                    </div>
                </div>
                
                <div class="mt-6 p-4 bg-gradient-to-r from-purple-100 to-blue-100 rounded-lg">
                    <div class="flex justify-between items-center mb-2">
                        <strong class="text-lg">üìä Bank Soal: <span id="question-count" class="text-purple-600">0</span> soal</strong>
                        <div class="text-sm text-gray-600">
                            <span id="question-info">Import atau tambah soal untuk memulai</span>
                        </div>
                    </div>
                    <div id="question-preview" class="max-h-32 overflow-y-auto text-sm mt-2 space-y-1"></div>
                </div>
            </div>

            <!-- Team Setup -->
            <div class="bg-white/95 rounded-lg p-6 shadow-lg">
                <h2 class="game-font text-2xl text-center mb-6 text-purple-800">üë• Setup Tim & Game</h2>
                
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div class="text-center">
                        <h3 class="font-bold mb-3 text-lg">Jumlah Tim</h3>
                        <div class="flex justify-center gap-3 flex-wrap">
                            <button class="team-count-btn bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg transition-all" data-count="2">2 Tim</button>
                            <button class="team-count-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-lg transition-all" data-count="3">3 Tim</button>
                            <button class="team-count-btn bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-all" data-count="4">4 Tim</button>
                            <button class="team-count-btn bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-lg transition-all" data-count="5">5 Tim</button>
                        </div>
                    </div>

                    <div class="text-center">
                        <h3 class="font-bold mb-3 text-lg">Jumlah Soal</h3>
                        <div class="flex justify-center gap-2 flex-wrap">
                            <button class="question-count-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition-all" data-count="10">10</button>
                            <button class="question-count-btn bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg transition-all" data-count="15">15</button>
                            <button class="question-count-btn bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-all" data-count="20">20</button>
                            <button class="question-count-btn bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition-all" data-count="25">25</button>
                            <button class="question-count-btn bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-all" data-count="30">30</button>
                        </div>
                        <div class="text-sm text-gray-600 mt-2">
                            Pilih berapa soal yang akan dimainkan
                        </div>
                    </div>
                </div>

                <div id="team-names" class="mb-6">
                    <!-- Team name inputs will be generated here -->
                </div>

                <div class="text-center">
                    <button id="start-game-btn" class="game-button text-xl px-12 py-4 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        <i class="fas fa-play mr-3"></i>MULAI GAME SHOW!
                    </button>
                </div>
            </div>

            <!-- Game Rules -->
            <div class="bg-white/95 rounded-lg p-6 shadow-lg">
                <h3 class="font-bold text-center mb-4 text-lg">üìã Cara Bermain (Format Presentasi Kelas)</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-bold text-blue-800 mb-2">üéØ Alur Permainan:</h4>
                        <ul class="text-sm space-y-1">
                            <li>‚Ä¢ Tim bergantian menjawab soal</li>
                            <li>‚Ä¢ Guru tampilkan di proyektor</li>
                            <li>‚Ä¢ Tim diskusi & sebut jawaban</li>
                            <li>‚Ä¢ Guru klik pilihan tim</li>
                        </ul>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h4 class="font-bold text-green-800 mb-2">üèÜ Sistem Poin:</h4>
                        <ul class="text-sm space-y-1">
                            <li>‚Ä¢ Benar: +100 poin ‚úÖ</li>
                            <li>‚Ä¢ Salah: -50 poin ‚ùå</li>
                            <li>‚Ä¢ Waktu habis: -50 poin ‚è∞</li>
                            <li>‚Ä¢ Waktu: 30 detik per soal</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="hidden">
            <!-- Game Header -->
            <div class="bg-gradient-to-r from-purple-600 to-blue-600 text-white p-4 rounded-lg mb-6 shadow-lg">
                <div class="flex justify-between items-center mb-3">
                    <div class="bg-yellow-400 text-purple-800 px-6 py-3 rounded-full font-bold text-xl">
                        <i class="fas fa-star mr-2"></i><span id="current-team">Tim 1</span>
                    </div>
                    
                    <div class="bg-white/20 px-6 py-3 rounded-lg font-bold text-xl">
                        Soal <span id="current-question-number">1</span> dari <span id="total-questions-display">10</span>
                    </div>
                    
                    <div id="timer-display" class="bg-green-500 px-6 py-3 rounded-full font-bold text-2xl">
                        <i class="fas fa-clock mr-2"></i><span id="question-timer">30</span>s
                    </div>
                </div>
                
                <!-- Progress Bar -->
                <div class="bg-white/20 rounded-full h-3 mb-2">
                    <div id="progress-bar" class="bg-yellow-400 h-3 rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>
                <div class="text-center text-white text-sm font-bold">
                    <span id="progress-text">0% Selesai</span>
                </div>
            </div>

            <!-- Question Display -->
            <div class="bg-white rounded-xl p-8 mb-6 shadow-lg">
                <h2 id="question-text" class="text-2xl md:text-3xl font-bold text-gray-800 text-center leading-relaxed min-h-[80px] flex items-center justify-center">
                    Pertanyaan akan muncul di sini...
                </h2>
            </div>
            
            <!-- Answer Options -->
            <div id="question-options" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <!-- Options will be generated here -->
            </div>
            
            <!-- Game Controls -->
            <div class="bg-white/95 rounded-lg p-4 mb-6 shadow-lg">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="game-font text-lg text-purple-800">
                        <i class="fas fa-trophy text-yellow-500"></i> SKOR TIM
                    </h3>
                    <div class="flex gap-2">
                        <button id="pause-game-btn" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg transition-all">
                            <i class="fas fa-pause mr-1"></i>Jeda
                        </button>
                        <button id="skip-question-btn" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition-all">
                            <i class="fas fa-forward mr-1"></i>Lewati
                        </button>
                        <button id="end-game-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-all">
                            <i class="fas fa-stop mr-1"></i>Akhiri
                        </button>
                    </div>
                </div>
                <div id="team-scores" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3">
                    <!-- Team scores will be generated here -->
                </div>
            </div>
            
            <!-- Next Question Button -->
            <div class="text-center">
                <button id="next-question-btn" class="game-button text-lg px-8 py-3 hidden">
                    <i class="fas fa-arrow-right mr-2"></i>Soal Berikutnya
                </button>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden text-center">
            <div class="bg-white/90 backdrop-blur-sm rounded-3xl p-8 max-w-4xl mx-auto shadow-2xl">
                <h2 class="game-font text-4xl md:text-6xl mb-8 text-purple-800">
                    <i class="fas fa-crown text-yellow-500"></i> HASIL AKHIR <i class="fas fa-crown text-yellow-500"></i>
                </h2>
                
                <div id="final-rankings" class="space-y-4 mb-8">
                    <!-- Final rankings will be generated here -->
                </div>

                <div class="flex justify-center gap-4 flex-wrap">
                    <button id="restart-btn" class="game-button text-xl px-8 py-4">
                        <i class="fas fa-redo mr-2"></i> Main Lagi
                    </button>
                    <button id="export-results-btn" class="game-button text-xl px-8 py-4">
                        <i class="fas fa-download mr-2"></i> Export Hasil
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        class GameShow {
            constructor() {
                this.questions = [
                    // Default questions
                    { question: "Apa ibu kota Indonesia?", options: ["Jakarta", "Surabaya", "Bandung", "Medan"], correct: 0, language: "indonesia" },
                    { question: "Berapa hasil dari 7 √ó 8?", options: ["54", "56", "58", "52"], correct: 1, language: "indonesia" },
                    { question: "ŸÉŸÖ ÿπÿØÿØ ÿßŸÑÿµŸÑŸàÿßÿ™ ŸÅŸä ÿßŸÑŸäŸàŸÖÿü", options: ["ÿ´ŸÑÿßÿ´", "ÿ£ÿ±ÿ®ÿπ", "ÿÆŸÖÿ≥", "ÿ≥ÿ™"], correct: 2, language: "arabic" },
                    { question: "What color do you get when you mix red and blue?", options: ["Green", "Purple", "Orange", "Yellow"], correct: 1, language: "english" },
                    { question: "Siapa penemu telepon?", options: ["Edison", "Alexander Bell", "Tesla", "Einstein"], correct: 1, language: "indonesia" },
                    { question: "ŸÖÿß ŸáŸà ÿ£ŸÉÿ®ÿ± ŸÉŸàŸÉÿ® ŸÅŸä ÿßŸÑŸÜÿ∏ÿßŸÖ ÿßŸÑÿ¥ŸÖÿ≥Ÿäÿü", options: ["ÿßŸÑÿ£ÿ±ÿ∂", "ÿßŸÑŸÖÿ¥ÿ™ÿ±Ÿä", "ÿ≤ÿ≠ŸÑ", "ÿßŸÑŸÖÿ±ŸäÿÆ"], correct: 1, language: "arabic" },
                    { question: "How many days are there in a week?", options: ["6", "7", "8", "5"], correct: 1, language: "english" },
                    { question: "Berapa jumlah benua di dunia?", options: ["5", "6", "7", "8"], correct: 2, language: "indonesia" },
                    { question: "ŸÖÿß ŸáŸä ÿπÿßÿµŸÖÿ© ŸÖÿµÿ±ÿü", options: ["ÿßŸÑÿ•ÿ≥ŸÉŸÜÿØÿ±Ÿäÿ©", "ÿßŸÑŸÇÿßŸáÿ±ÿ©", "ÿßŸÑÿ¨Ÿäÿ≤ÿ©", "ÿ£ÿ≥ŸàÿßŸÜ"], correct: 1, language: "arabic" },
                    { question: "What is 10 + 15?", options: ["20", "25", "30", "35"], correct: 1, language: "english" }
                ];
                
                // Sound effects
                this.sounds = {
                    correct: new Audio('https://archive.org/download/jeopardy_202509/rightanswer.mp3'),
                    wrong: new Audio('https://archive.org/download/jeopardy_202509/jeopardy-incorrect-answer.mp3'),
                    timeout: new Audio('https://archive.org/download/jeopardy_202509/times-up_AN8OlqZ.mp3')
                };
                
                // Configure sound settings
                Object.values(this.sounds).forEach(sound => {
                    sound.volume = 0.7;
                    sound.preload = 'auto';
                });
                
                this.teams = [];
                this.currentTeamIndex = 0;
                this.currentQuestionIndex = 0;
                this.totalQuestions = 0;
                this.gameQuestions = [];
                this.gameActive = false;
                this.questionTimer = null;
                this.timeLeft = 30;
                this.gamePaused = false;
                this.stats = {
                    correct: 0,
                    wrong: 0,
                    timeout: 0
                };
                this.teamColors = [
                    'bg-gradient-to-r from-red-400 to-red-600',
                    'bg-gradient-to-r from-blue-400 to-blue-600',
                    'bg-gradient-to-r from-green-400 to-green-600',
                    'bg-gradient-to-r from-yellow-400 to-yellow-600',
                    'bg-gradient-to-r from-purple-400 to-purple-600'
                ];
                
                this.initializeElements();
                this.bindEvents();
                this.updateQuestionCount();
            }
            
            initializeElements() {
                this.setupScreen = document.getElementById('setup-screen');
                this.gameScreen = document.getElementById('game-screen');
                this.resultsScreen = document.getElementById('results-screen');
                this.teamNamesContainer = document.getElementById('team-names');
                this.startGameBtn = document.getElementById('start-game-btn');
                this.restartBtn = document.getElementById('restart-btn');
                this.teamScoresContainer = document.getElementById('team-scores');
                this.currentTeamElement = document.getElementById('current-team');
                this.timerDisplay = document.getElementById('timer-display');
                this.questionTimerElement = document.getElementById('question-timer');
                this.questionText = document.getElementById('question-text');
                this.questionOptions = document.getElementById('question-options');
                this.currentQuestionNumber = document.getElementById('current-question-number');
                this.nextQuestionBtn = document.getElementById('next-question-btn');
                this.finalRankingsElement = document.getElementById('final-rankings');
                this.questionCountElement = document.getElementById('question-count');
                this.questionPreview = document.getElementById('question-preview');
            }
            
            bindEvents() {
                // Team count selection
                document.querySelectorAll('.team-count-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.team-count-btn').forEach(b => b.classList.remove('ring-4', 'ring-white'));
                        e.target.classList.add('ring-4', 'ring-white');
                        this.setupTeamNames(parseInt(e.target.dataset.count));
                    });
                });
                
                // Question count selection
                document.querySelectorAll('.question-count-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.question-count-btn').forEach(b => b.classList.remove('ring-4', 'ring-white'));
                        e.target.classList.add('ring-4', 'ring-white');
                        this.totalQuestions = parseInt(e.target.dataset.count);
                        this.checkStartButton();
                    });
                });
                
                this.startGameBtn.addEventListener('click', () => this.startGame());
                this.restartBtn.addEventListener('click', () => this.restartGame());
                this.nextQuestionBtn.addEventListener('click', () => this.nextQuestion());
                document.getElementById('export-results-btn').addEventListener('click', () => this.exportResults());
                
                // Game control buttons
                document.getElementById('pause-game-btn').addEventListener('click', () => this.pauseGame());
                document.getElementById('skip-question-btn').addEventListener('click', () => this.skipQuestion());
                document.getElementById('end-game-btn').addEventListener('click', () => this.confirmEndGame());
            }
            
            setupTeamNames(count) {
                this.teamNamesContainer.innerHTML = '';
                
                const div = document.createElement('div');
                div.className = 'grid grid-cols-1 md:grid-cols-2 gap-4';
                
                for (let i = 0; i < count; i++) {
                    const teamDiv = document.createElement('div');
                    teamDiv.className = `${this.teamColors[i]} p-4 rounded-lg text-center shadow-lg`;
                    teamDiv.innerHTML = `
                        <label class="block font-bold mb-3 text-white text-lg">Tim ${i + 1}:</label>
                        <input type="text" class="team-name-input w-full p-3 border rounded-lg text-center font-bold text-gray-800" placeholder="Masukkan Nama Tim ${i + 1}" maxlength="20">
                    `;
                    div.appendChild(teamDiv);
                }
                
                this.teamNamesContainer.appendChild(div);
                
                // Enable start button when setup is complete
                const inputs = document.querySelectorAll('.team-name-input');
                inputs.forEach(input => {
                    input.addEventListener('input', () => {
                        this.checkStartButton();
                    });
                });
                
                setTimeout(() => {
                    this.checkStartButton();
                }, 100);
            }
            
            checkStartButton() {
                const inputs = document.querySelectorAll('.team-name-input');
                const hasQuestions = this.questions.length > 0;
                const hasTeams = inputs.length > 0;
                const hasQuestionCount = this.totalQuestions > 0;
                
                // Update info about available questions
                const infoElement = document.getElementById('question-info');
                if (this.questions.length > 0 && this.totalQuestions > 0) {
                    const gameQuestions = Math.min(this.totalQuestions, this.questions.length);
                    infoElement.textContent = `Tersedia ${this.questions.length} soal. Game akan menggunakan ${gameQuestions} soal acak.`;
                } else if (this.questions.length > 0) {
                    infoElement.textContent = `Tersedia ${this.questions.length} soal. Pilih jumlah soal yang akan dimainkan.`;
                } else {
                    infoElement.textContent = 'Import atau tambah soal terlebih dahulu';
                }
                
                this.startGameBtn.disabled = !(hasQuestions && hasTeams && hasQuestionCount);
            }
            
            importQuestions() {
                const fileInput = document.getElementById('question-file');
                const file = fileInput.files[0];
                
                if (!file) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'Oops!',
                        text: 'Pilih file Excel terlebih dahulu!',
                        timer: 3000
                    });
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        const sheetName = workbook.SheetNames[0];
                        const worksheet = workbook.Sheets[sheetName];
                        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                        
                        let importedQuestions = [];
                        
                        // Skip header row (index 0)
                        for (let i = 1; i < jsonData.length; i++) {
                            const row = jsonData[i];
                            if (row.length >= 6 && row[0]) {
                                const question = {
                                    question: row[0].toString().trim(),
                                    options: [
                                        row[1] ? row[1].toString().trim() : '',
                                        row[2] ? row[2].toString().trim() : '',
                                        row[3] ? row[3].toString().trim() : '',
                                        row[4] ? row[4].toString().trim() : ''
                                    ],
                                    correct: this.parseCorrectAnswer(row[5]),
                                    category: row[6] ? row[6].toString().trim() : 'Umum',
                                    language: row[7] ? row[7].toString().trim() : 'indonesia'
                                };
                                
                                if (question.question && question.options.every(opt => opt) && question.correct !== -1) {
                                    importedQuestions.push(question);
                                }
                            }
                        }
                        
                        if (importedQuestions.length > 0) {
                            this.questions = importedQuestions;
                            this.updateQuestionCount();
                            this.updateQuestionPreview();
                            
                            Swal.fire({
                                icon: 'success',
                                title: 'Berhasil!',
                                text: `${importedQuestions.length} soal berhasil diimport dari Excel!`,
                                timer: 3000
                            });
                        } else {
                            Swal.fire({
                                icon: 'warning',
                                title: 'Tidak Ada Data!',
                                text: 'File Excel tidak berisi soal yang valid!',
                                timer: 3000
                            });
                        }
                    } catch (error) {
                        Swal.fire({
                            icon: 'error',
                            title: 'Error!',
                            text: 'Gagal membaca file Excel! Pastikan format sesuai template.',
                            timer: 3000
                        });
                    }
                };
                reader.readAsArrayBuffer(file);
            }
            
            parseCorrectAnswer(answer) {
                if (!answer) return -1;
                const answerStr = answer.toString().toLowerCase().trim();
                
                if (answerStr === 'a' || answerStr === '1' || answerStr === '0') return 0;
                if (answerStr === 'b' || answerStr === '2' || answerStr === '1') return 1;
                if (answerStr === 'c' || answerStr === '3' || answerStr === '2') return 2;
                if (answerStr === 'd' || answerStr === '4' || answerStr === '3') return 3;
                
                return -1;
            }
            
            downloadTemplate() {
                const templateData = [
                    ['Pertanyaan', 'Opsi A', 'Opsi B', 'Opsi C', 'Opsi D', 'Jawaban Benar', 'Kategori', 'Bahasa'],
                    ['Apa ibu kota Indonesia?', 'Jakarta', 'Surabaya', 'Bandung', 'Medan', 'A', 'Geografi', 'indonesia'],
                    ['Berapa hasil dari 7 √ó 8?', '54', '56', '58', '52', 'B', 'Matematika', 'indonesia'],
                    ['ŸÉŸÖ ÿπÿØÿØ ÿßŸÑÿµŸÑŸàÿßÿ™ ŸÅŸä ÿßŸÑŸäŸàŸÖÿü', 'ÿ´ŸÑÿßÿ´', 'ÿ£ÿ±ÿ®ÿπ', 'ÿÆŸÖÿ≥', 'ÿ≥ÿ™', 'C', 'Agama', 'arabic'],
                    ['What color do you get when you mix red and blue?', 'Green', 'Purple', 'Orange', 'Yellow', 'B', 'Science', 'english']
                ];
                
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(templateData);
                
                ws['!cols'] = [
                    { wch: 40 }, { wch: 20 }, { wch: 20 }, { wch: 20 }, { wch: 20 }, { wch: 15 }, { wch: 15 }, { wch: 12 }
                ];
                
                XLSX.utils.book_append_sheet(wb, ws, 'Soal Game Show');
                XLSX.writeFile(wb, 'Template_Soal_Game_Show.xlsx');
                
                Swal.fire({
                    icon: 'success',
                    title: 'Template Downloaded!',
                    text: 'File template Excel telah didownload. Isi soal sesuai format lalu import kembali.',
                    timer: 4000
                });
            }
            
            containsArabic(text) {
                const arabicRegex = /[\u0600-\u06FF\u0750-\u077F]/;
                return arabicRegex.test(text);
            }
            
            addManualQuestion() {
                const question = document.getElementById('manual-question').value.trim();
                const optionA = document.getElementById('manual-a').value.trim();
                const optionB = document.getElementById('manual-b').value.trim();
                const optionC = document.getElementById('manual-c').value.trim();
                const optionD = document.getElementById('manual-d').value.trim();
                const correct = document.getElementById('manual-correct').value;
                const language = document.getElementById('manual-language').value;
                
                if (!question || !optionA || !optionB || !optionC || !optionD || !correct) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'Lengkapi Data!',
                        text: 'Semua field harus diisi!',
                        timer: 3000
                    });
                    return;
                }
                
                const newQuestion = {
                    question: question,
                    options: [optionA, optionB, optionC, optionD],
                    correct: ['a', 'b', 'c', 'd'].indexOf(correct),
                    language: language
                };
                
                this.questions.push(newQuestion);
                this.updateQuestionCount();
                this.updateQuestionPreview();
                
                // Clear form
                document.getElementById('manual-question').value = '';
                document.getElementById('manual-a').value = '';
                document.getElementById('manual-b').value = '';
                document.getElementById('manual-c').value = '';
                document.getElementById('manual-d').value = '';
                document.getElementById('manual-correct').value = '';
                
                Swal.fire({
                    icon: 'success',
                    title: 'Berhasil!',
                    text: 'Soal berhasil ditambahkan!',
                    timer: 3000
                });
                
                this.checkStartButton();
            }
            
            updateQuestionCount() {
                this.questionCountElement.textContent = this.questions.length;
                this.checkStartButton();
            }
            
            updateQuestionPreview() {
                const preview = this.questions.slice(-3).map((q, index) => 
                    `<div class="bg-white p-3 rounded-lg shadow-sm border-l-4 border-purple-400">
                        <div class="font-bold text-sm text-purple-800">${this.questions.length - 2 + index}. ${q.question.substring(0, 60)}${q.question.length > 60 ? '...' : ''}</div>
                        <div class="text-xs text-gray-500 mt-1">Bahasa: ${q.language} | Jawaban: ${['A', 'B', 'C', 'D'][q.correct]}</div>
                    </div>`
                ).join('');
                
                this.questionPreview.innerHTML = preview;
            }
            
            startGame() {
                // Get team names
                const nameInputs = document.querySelectorAll('.team-name-input');
                this.teams = Array.from(nameInputs).map((input, index) => ({
                    id: index,
                    name: input.value.trim() || `Tim ${index + 1}`,
                    score: 0,
                    color: this.teamColors[index]
                }));
                
                // Select random questions
                let gameQuestions = [...this.questions];
                gameQuestions = this.shuffleArray(gameQuestions);
                
                const maxGameQuestions = Math.min(this.totalQuestions, gameQuestions.length);
                this.gameQuestions = gameQuestions.slice(0, maxGameQuestions);
                
                this.gameQuestions.forEach(question => {
                    this.shuffleQuestionOptions(question);
                });
                
                this.currentTeamIndex = 0;
                this.currentQuestionIndex = 0;
                this.gameActive = true;
                
                this.showScreen('game');
                this.createTeamScoreboards();
                this.showQuestion();
                this.createConfetti();
                
                Swal.fire({
                    icon: 'success',
                    title: 'Game Dimulai!',
                    text: `${this.gameQuestions.length} soal acak telah dipilih! Selamat bermain!`,
                    timer: 2000
                });
            }
            
            shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }
            
            shuffleQuestionOptions(question) {
                const correctAnswerText = question.options[question.correct];
                
                const optionsWithIndex = question.options.map((option, index) => ({
                    text: option,
                    originalIndex: index
                }));
                
                for (let i = optionsWithIndex.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [optionsWithIndex[i], optionsWithIndex[j]] = [optionsWithIndex[j], optionsWithIndex[i]];
                }
                
                question.options = optionsWithIndex.map(item => item.text);
                question.correct = question.options.findIndex(option => option === correctAnswerText);
            }
            
            createTeamScoreboards() {
                this.teamScoresContainer.innerHTML = '';
                
                this.teams.forEach((team, index) => {
                    const div = document.createElement('div');
                    div.className = `${team.color} rounded-lg p-3 text-center shadow-lg text-white transition-all`;
                    div.innerHTML = `
                        <div class="font-bold text-sm mb-1">${team.name}</div>
                        <div class="text-2xl font-black team-score" data-team="${team.id}">0</div>
                        <div class="text-xs opacity-75">poin</div>
                    `;
                    this.teamScoresContainer.appendChild(div);
                });
            }
            
            showQuestion() {
                if (this.currentQuestionIndex >= this.gameQuestions.length) {
                    this.endGame();
                    return;
                }
                
                const question = this.gameQuestions[this.currentQuestionIndex];
                
                this.currentQuestionNumber.textContent = this.currentQuestionIndex + 1;
                document.getElementById('total-questions-display').textContent = this.gameQuestions.length;
                
                // Update progress bar
                const progress = ((this.currentQuestionIndex) / this.gameQuestions.length) * 100;
                document.getElementById('progress-bar').style.width = progress + '%';
                document.getElementById('progress-text').textContent = Math.round(progress) + '% Selesai';
                
                // Set question text with proper styling
                this.questionText.className = 'text-2xl md:text-3xl font-bold text-gray-800 text-center leading-relaxed min-h-[80px] flex items-center justify-center';
                
                if (this.containsArabic(question.question)) {
                    this.questionText.classList.add('arabic-font');
                }
                
                this.questionText.textContent = question.question;
                
                // Create answer options
                this.questionOptions.innerHTML = '';
                
                question.options.forEach((option, index) => {
                    const optionCard = document.createElement('button');
                    optionCard.className = `${this.getOptionColor(index)} text-white rounded-xl p-6 text-left shadow-lg transform hover:scale-105 transition-all duration-300 cursor-pointer option-card`;
                    optionCard.dataset.option = index;
                    optionCard.innerHTML = `
                        <div class="flex items-center gap-4">
                            <div class="bg-white text-gray-800 font-black text-2xl w-12 h-12 rounded-full flex items-center justify-center shadow-md flex-shrink-0">
                                ${['A', 'B', 'C', 'D'][index]}
                            </div>
                            <div class="text-lg font-bold ${this.containsArabic(option) ? 'arabic-font' : ''} flex-1">
                                ${option}
                            </div>
                        </div>
                    `;
                    
                    optionCard.addEventListener('click', () => {
                        this.selectAnswer(index);
                    });
                    
                    this.questionOptions.appendChild(optionCard);
                });
                
                // Add instruction
                const instructionDiv = document.createElement('div');
                instructionDiv.className = 'col-span-full bg-blue-100 rounded-xl p-4 text-center mt-4';
                instructionDiv.innerHTML = `
                    <p class="text-lg font-bold text-blue-800">
                        üì¢ Guru: Klik jawaban yang dipilih tim untuk melihat hasilnya
                    </p>
                    <p class="text-sm text-blue-600 mt-2">
                        Tim yang sedang bermain: <span class="font-bold">${this.teams[this.currentTeamIndex].name}</span>
                    </p>
                `;
                this.questionOptions.appendChild(instructionDiv);
                
                this.updateCurrentTeam();
                this.startQuestionTimer();
            }
            
            getOptionColor(index) {
                const colors = [
                    'bg-gradient-to-r from-red-500 to-red-600',
                    'bg-gradient-to-r from-blue-500 to-blue-600', 
                    'bg-gradient-to-r from-green-500 to-green-600',
                    'bg-gradient-to-r from-purple-500 to-purple-600'
                ];
                return colors[index];
            }
            
            updateCurrentTeam() {
                this.currentTeamElement.textContent = this.teams[this.currentTeamIndex].name;
                
                // Highlight current team in scoreboard
                document.querySelectorAll('.team-score').forEach((scoreEl, index) => {
                    const teamCard = scoreEl.closest('div');
                    teamCard.classList.remove('ring-4', 'ring-yellow-300', 'scale-110');
                    
                    if (index === this.currentTeamIndex) {
                        teamCard.classList.add('ring-4', 'ring-yellow-300', 'scale-110');
                    }
                });
            }
            
            selectAnswer(selectedOption) {
                if (!this.gameActive) return;
                
                clearInterval(this.questionTimer);
                this.timerDisplay.classList.add('hidden');
                
                const question = this.gameQuestions[this.currentQuestionIndex];
                const isCorrect = selectedOption === question.correct;
                const currentTeam = this.teams[this.currentTeamIndex];
                
                // Disable all option cards
                document.querySelectorAll('.option-card').forEach(card => {
                    card.style.pointerEvents = 'none';
                    card.classList.remove('hover:scale-105');
                });
                
                const selectedCard = document.querySelector(`[data-option="${selectedOption}"]`);
                const correctCard = document.querySelector(`[data-option="${question.correct}"]`);
                
                if (isCorrect) {
                    selectedCard.classList.add('ring-8', 'ring-green-400');
                    selectedCard.innerHTML += '<div class="text-center mt-4"><div class="text-4xl">‚úÖ</div><div class="font-bold text-lg">BENAR!</div></div>';
                    
                    currentTeam.score += 100;
                    this.stats.correct++;
                    this.playSound('correct');
                    this.addSparkleEffect(selectedCard);
                    this.showScoreAnimation('+100', currentTeam.id, '#10b981');
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'üéâ BENAR! üéâ',
                        text: `${currentTeam.name} mendapat 100 poin!`,
                        timer: 3000,
                        showConfirmButton: false
                    });
                } else {
                    selectedCard.classList.add('ring-8', 'ring-red-400');
                    selectedCard.innerHTML += '<div class="text-center mt-4"><div class="text-4xl">‚ùå</div><div class="font-bold text-lg">SALAH!</div></div>';
                    
                    correctCard.classList.add('ring-8', 'ring-green-400');
                    correctCard.innerHTML += '<div class="text-center mt-4"><div class="text-4xl">‚úÖ</div><div class="font-bold text-lg">BENAR</div></div>';
                    
                    currentTeam.score = Math.max(0, currentTeam.score - 50);
                    this.stats.wrong++;
                    this.playSound('wrong');
                    this.showScoreAnimation('-50', currentTeam.id, '#ef4444');
                    
                    Swal.fire({
                        icon: 'error',
                        title: '‚ùå SALAH!',
                        text: `${currentTeam.name} kehilangan 50 poin. Jawaban benar: ${['A', 'B', 'C', 'D'][question.correct]}`,
                        timer: 4000,
                        showConfirmButton: false
                    });
                }
                
                this.updateTeamScores();
                
                setTimeout(() => {
                    this.nextQuestionBtn.classList.remove('hidden');
                }, 2000);
            }
            
            startQuestionTimer() {
                this.timeLeft = 30;
                this.timerDisplay.classList.remove('hidden');
                this.updateQuestionTimer();
                
                this.questionTimer = setInterval(() => {
                    if (!this.gamePaused) {
                        this.timeLeft--;
                        this.updateQuestionTimer();
                        
                        if (this.timeLeft <= 0) {
                            this.timeUp();
                        }
                    }
                }, 1000);
            }
            
            updateQuestionTimer() {
                this.questionTimerElement.textContent = this.timeLeft;
                
                this.timerDisplay.classList.remove('bg-red-500', 'bg-orange-500', 'bg-green-500');
                
                if (this.timeLeft <= 5) {
                    this.timerDisplay.classList.add('bg-red-500', 'animate-pulse');
                } else if (this.timeLeft <= 10) {
                    this.timerDisplay.classList.add('bg-orange-500');
                    this.timerDisplay.classList.remove('animate-pulse');
                } else {
                    this.timerDisplay.classList.add('bg-green-500');
                    this.timerDisplay.classList.remove('animate-pulse');
                }
            }
            
            timeUp() {
                if (!this.gameActive) return;
                
                clearInterval(this.questionTimer);
                this.timerDisplay.classList.add('hidden');
                
                const question = this.gameQuestions[this.currentQuestionIndex];
                const currentTeam = this.teams[this.currentTeamIndex];
                
                const correctCard = document.querySelector(`[data-option="${question.correct}"]`);
                correctCard.classList.add('ring-8', 'ring-green-400');
                correctCard.innerHTML += '<div class="text-center mt-4"><div class="text-4xl">‚è∞</div><div class="font-bold text-lg">WAKTU HABIS</div></div>';
                
                document.querySelectorAll('.option-card').forEach(card => {
                    card.style.pointerEvents = 'none';
                    card.classList.remove('hover:scale-105');
                });
                
                currentTeam.score = Math.max(0, currentTeam.score - 50);
                this.stats.timeout++;
                this.playSound('timeout');
                this.showScoreAnimation('-50', currentTeam.id, '#f59e0b');
                
                Swal.fire({
                    icon: 'warning',
                    title: '‚è∞ WAKTU HABIS!',
                    text: `${currentTeam.name} kehilangan 50 poin. Jawaban benar: ${['A', 'B', 'C', 'D'][question.correct]}`,
                    timer: 4000,
                    showConfirmButton: false
                });
                
                this.updateTeamScores();
                
                setTimeout(() => {
                    this.nextQuestionBtn.classList.remove('hidden');
                }, 2000);
            }
            
            nextQuestion() {
                document.querySelectorAll('.sparkle').forEach(sparkle => sparkle.remove());
                document.querySelectorAll('.confetti').forEach(confetti => confetti.remove());
                
                this.nextQuestionBtn.classList.add('hidden');
                
                this.currentTeamIndex = (this.currentTeamIndex + 1) % this.teams.length;
                this.currentQuestionIndex++;
                
                if (this.currentQuestionIndex < this.gameQuestions.length) {
                    this.showQuestion();
                } else {
                    this.endGame();
                }
            }
            
            showScoreAnimation(scoreText, teamId, color) {
                const teamCard = document.querySelector(`[data-team="${teamId}"]`).closest('div');
                const rect = teamCard.getBoundingClientRect();
                
                const scorePopup = document.createElement('div');
                scorePopup.textContent = scoreText;
                scorePopup.style.position = 'fixed';
                scorePopup.style.left = (rect.left + rect.width / 2) + 'px';
                scorePopup.style.top = rect.top + 'px';
                scorePopup.style.fontSize = '2rem';
                scorePopup.style.fontWeight = 'bold';
                scorePopup.style.color = color;
                scorePopup.style.textShadow = '2px 2px 4px rgba(0,0,0,0.5)';
                scorePopup.style.pointerEvents = 'none';
                scorePopup.style.zIndex = '9999';
                scorePopup.style.transform = 'translateX(-50%)';
                scorePopup.classList.add('score-fly');
                
                document.body.appendChild(scorePopup);
                
                setTimeout(() => {
                    scorePopup.remove();
                }, 1500);
            }
            
            updateTeamScores() {
                this.teams.forEach(team => {
                    const scoreElement = document.querySelector(`[data-team="${team.id}"]`);
                    if (scoreElement) {
                        scoreElement.textContent = team.score;
                        scoreElement.classList.add('bounce-in');
                        
                        if (team.id === this.currentTeamIndex) {
                            const teamCard = scoreElement.closest('div');
                            teamCard.classList.add('pulse-glow');
                            setTimeout(() => {
                                teamCard.classList.remove('pulse-glow');
                            }, 2000);
                        }
                        
                        setTimeout(() => scoreElement.classList.remove('bounce-in'), 800);
                    }
                });
            }
            
            playSound(type) {
                try {
                    if (this.sounds[type]) {
                        this.sounds[type].currentTime = 0;
                        this.sounds[type].play().catch(error => {
                            console.log('Sound play failed:', error);
                        });
                    }
                } catch (error) {
                    console.log('Sound error:', error);
                }
            }
            
            addSparkleEffect(element) {
                const rect = element.getBoundingClientRect();
                for (let i = 0; i < 8; i++) {
                    setTimeout(() => {
                        const sparkle = document.createElement('div');
                        sparkle.innerHTML = '‚ú®';
                        sparkle.style.position = 'fixed';
                        sparkle.style.left = (rect.left + Math.random() * rect.width) + 'px';
                        sparkle.style.top = (rect.top + Math.random() * rect.height) + 'px';
                        sparkle.style.fontSize = '20px';
                        sparkle.style.pointerEvents = 'none';
                        sparkle.style.zIndex = '9999';
                        sparkle.classList.add('sparkle');
                        document.body.appendChild(sparkle);
                        
                        setTimeout(() => {
                            sparkle.remove();
                        }, 2000);
                    }, i * 100);
                }
            }
            
            createCelebrationEffect() {
                for (let i = 0; i < 50; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = Math.random() * 100 + 'vw';
                        confetti.style.backgroundColor = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3'][Math.floor(Math.random() * 6)];
                        confetti.style.animationDelay = Math.random() * 2 + 's';
                        document.body.appendChild(confetti);
                        
                        setTimeout(() => {
                            confetti.remove();
                        }, 3000);
                    }, i * 50);
                }
            }
            
            createConfetti() {
                setInterval(() => {
                    if (this.gameActive) {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = Math.random() * 100 + 'vw';
                        confetti.style.backgroundColor = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3'][Math.floor(Math.random() * 6)];
                        document.body.appendChild(confetti);
                        
                        setTimeout(() => {
                            confetti.remove();
                        }, 3000);
                    }
                }, 2000);
            }
            
            endGame() {
                this.gameActive = false;
                this.showScreen('results');
                
                const sortedTeams = [...this.teams].sort((a, b) => b.score - a.score);
                
                this.finalRankingsElement.innerHTML = '';
                sortedTeams.forEach((team, index) => {
                    const div = document.createElement('div');
                    let rankEmoji = '';
                    let rankClass = '';
                    
                    if (index === 0) {
                        rankEmoji = 'ü•á';
                        rankClass = 'pulse-glow';
                    } else if (index === 1) {
                        rankEmoji = 'ü•à';
                    } else if (index === 2) {
                        rankEmoji = 'ü•â';
                    } else {
                        rankEmoji = `${index + 1}.`;
                    }
                    
                    div.className = `${team.color} rounded-2xl p-6 flex justify-between items-center ${rankClass} transform hover:scale-105 transition-all duration-300 shadow-lg`;
                    div.innerHTML = `
                        <div class="flex items-center gap-4">
                            <span class="text-4xl">${rankEmoji}</span>
                            <span class="text-2xl font-bold text-white game-font">${team.name}</span>
                        </div>
                        <span class="text-3xl font-black text-white">${team.score} poin</span>
                    `;
                    this.finalRankingsElement.appendChild(div);
                });
                
                if (sortedTeams.length > 0) {
                    Swal.fire({
                        icon: 'success',
                        title: `üïå ŸÖÿ®ÿßÿ±ŸÉ! ${sortedTeams[0].name} üïå`,
                        text: `Juara Gebyar Maulid Nabi dengan ${sortedTeams[0].score} poin! ÿ®ÿßÿ±ŸÉ ÿßŸÑŸÑŸá ŸÅŸäŸÉŸÖ`,
                        confirmButtonText: 'Alhamdulillah!',
                        confirmButtonColor: '#10b981'
                    });
                    
                    this.createCelebrationEffect();
                }
            }
            
            exportResults() {
                const sortedTeams = [...this.teams].sort((a, b) => b.score - a.score);
                const results = {
                    timestamp: new Date().toISOString(),
                    totalQuestions: this.currentQuestionIndex,
                    teams: sortedTeams,
                    stats: this.stats
                };
                
                const dataStr = JSON.stringify(results, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `gebyar-maulid-nabi-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                
                Swal.fire({
                    icon: 'success',
                    title: 'Hasil Diexport!',
                    text: 'File hasil game telah didownload!',
                    timer: 3000
                });
            }
            
            pauseGame() {
                if (this.gamePaused) {
                    this.gamePaused = false;
                    this.startQuestionTimer();
                    document.getElementById('pause-game-btn').innerHTML = '<i class="fas fa-pause mr-1"></i>Jeda';
                    
                    Swal.fire({
                        icon: 'info',
                        title: 'Game Dilanjutkan!',
                        timer: 2000
                    });
                } else {
                    this.gamePaused = true;
                    clearInterval(this.questionTimer);
                    document.getElementById('pause-game-btn').innerHTML = '<i class="fas fa-play mr-1"></i>Lanjutkan';
                    
                    Swal.fire({
                        icon: 'info',
                        title: 'Game Dijeda',
                        text: 'Klik "Lanjutkan" untuk melanjutkan game',
                        timer: 3000
                    });
                }
            }
            
            skipQuestion() {
                Swal.fire({
                    title: 'Lewati Soal?',
                    text: 'Soal ini akan dilewati tanpa poin',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonColor: '#f59e0b',
                    cancelButtonColor: '#6b7280',
                    confirmButtonText: 'Ya, Lewati',
                    cancelButtonText: 'Batal'
                }).then((result) => {
                    if (result.isConfirmed) {
                        clearInterval(this.questionTimer);
                        this.nextQuestion();
                    }
                });
            }
            
            confirmEndGame() {
                Swal.fire({
                    title: 'Akhiri Game?',
                    text: 'Game akan berakhir dan hasil akan ditampilkan',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#ef4444',
                    cancelButtonColor: '#6b7280',
                    confirmButtonText: 'Ya, Akhiri',
                    cancelButtonText: 'Batal'
                }).then((result) => {
                    if (result.isConfirmed) {
                        this.endGame();
                    }
                });
            }
            
            restartGame() {
                Swal.fire({
                    title: 'Mulai Game Baru?',
                    text: 'Semua progress akan hilang!',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Ya, Mulai Baru!',
                    cancelButtonText: 'Batal'
                }).then((result) => {
                    if (result.isConfirmed) {
                        this.showScreen('setup');
                        this.teams = [];
                        this.currentQuestionIndex = 0;
                        this.currentTeamIndex = 0;
                        this.stats = { correct: 0, wrong: 0, timeout: 0 };
                        clearInterval(this.questionTimer);
                    }
                });
            }
            
            showScreen(screen) {
                this.setupScreen.classList.add('hidden');
                this.gameScreen.classList.add('hidden');
                this.resultsScreen.classList.add('hidden');
                
                if (screen === 'setup') {
                    this.setupScreen.classList.remove('hidden');
                } else if (screen === 'game') {
                    this.gameScreen.classList.remove('hidden');
                } else if (screen === 'results') {
                    this.resultsScreen.classList.remove('hidden');
                }
            }
        }
        
        // Global functions for HTML onclick events
        function importQuestions() {
            game.importQuestions();
        }
        
        function addManualQuestion() {
            game.addManualQuestion();
        }
        
        function downloadTemplate() {
            game.downloadTemplate();
        }
        
        // Initialize game when page loads
        let game;
        document.addEventListener('DOMContentLoaded', () => {
            game = new GameShow();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97caad9554404097',t:'MTc1NzQ2Mjc3Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
