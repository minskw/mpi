<!DOCTYPE html>
<html lang="id" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Show Cerdas Cermat Maulid Nabi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .arabic-text {
            font-family: 'Amiri', serif;
            font-size: 1.2em;
            line-height: 1.8;
        }
        .mixed-text {
            font-family: 'Inter', 'Amiri', sans-serif;
            line-height: 1.6;
            direction: ltr;
            text-align: left;
        }
        .arabic-only {
            font-family: 'Amiri', serif;
            line-height: 1.8;
            direction: rtl;
            text-align: right;
        }
        .question-image {
            max-width: 100%;
            max-height: 300px;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            margin: 20px auto;
            display: block;
        }
        .question-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            min-height: 160px;
            justify-content: center;
        }
        .question-text-only {
            text-align: center;
        }
        .question-with-image {
            text-align: center;
        }
        .timer-pulse {
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* Game Show Lights Animation */
        .game-show-header {
            position: relative;
            overflow: hidden;
        }
        
        .moving-lights {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 12px;
            pointer-events: none;
        }
        
        .light {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: radial-gradient(circle, #ffd700 0%, #ffed4e 50%, transparent 70%);
            box-shadow: 0 0 15px #ffd700, 0 0 25px #ffd700, 0 0 35px #ffd700;
            animation: moveLights 4s linear infinite;
        }
        
        .light:nth-child(1) { animation-delay: 0s; }
        .light:nth-child(2) { animation-delay: 0.2s; }
        .light:nth-child(3) { animation-delay: 0.4s; }
        .light:nth-child(4) { animation-delay: 0.6s; }
        .light:nth-child(5) { animation-delay: 0.8s; }
        .light:nth-child(6) { animation-delay: 1s; }
        .light:nth-child(7) { animation-delay: 1.2s; }
        .light:nth-child(8) { animation-delay: 1.4s; }
        .light:nth-child(9) { animation-delay: 1.6s; }
        .light:nth-child(10) { animation-delay: 1.8s; }
        
        @keyframes moveLights {
            0% {
                top: 0;
                left: 0;
                transform: translateX(0);
            }
            25% {
                top: 0;
                left: 100%;
                transform: translateX(-100%);
            }
            50% {
                top: 100%;
                left: 100%;
                transform: translateX(-100%) translateY(-100%);
            }
            75% {
                top: 100%;
                left: 0;
                transform: translateY(-100%);
            }
            100% {
                top: 0;
                left: 0;
                transform: translateX(0);
            }
        }
        
        .header-glow {
            animation: headerGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes headerGlow {
            0% {
                box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
            }
            100% {
                box-shadow: 0 0 40px rgba(16, 185, 129, 0.8), 0 0 60px rgba(20, 184, 166, 0.6);
            }
        }
        :root { 
            --duration: 30; /* seconds */ 
            --border: 8px; 
        }
        
        .timer-container {
            position: relative;
            border: 8px solid #374151;
            border-radius: 12px;
        }
        
        /* Border sweep */
        .timer-border {
            position: absolute;
            inset: 0;
            border-radius: 12px;
            padding: var(--border);
            pointer-events: none;
            z-index: 1;
            opacity: 0;
            transition: opacity 0.3s ease;
            -webkit-mask: linear-gradient(#000,#000) content-box, linear-gradient(#000,#000);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
        }

        .timer-border .sweep {
            position: absolute;
            inset: 0;
            border-radius: 12px;
            background: conic-gradient(from 0deg, gold 0deg, gold 0deg, transparent 0deg);
            will-change: background;
        }

        .timer-border.active {
            opacity: 1;
        }

        /* Sparkle effect */
        .sparkle {
            position: absolute;
            inset: 0;
            z-index: 2;
            pointer-events: none;
            mix-blend-mode: screen;
            opacity: 0;
            border-radius: 12px;
            background: radial-gradient(circle at center, gold 0%, transparent 70%);
        }
        
        .sparkle.active {
            opacity: 1;
            animation: spark-pop 1s ease-out 0s 1;
        }
        
        @keyframes spark-pop {
            0% { filter: blur(8px); opacity: 0; }
            40% { opacity: 1; filter: blur(2px); }
            100% { opacity: 0; filter: blur(10px); transform: scale(1.02); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-emerald-50 to-teal-100 min-h-screen">
    <div id="app" class="container mx-auto px-4 py-6">
        <!-- Header -->
        <div class="text-center mb-4 bg-gradient-to-r from-emerald-600 via-teal-600 to-emerald-600 rounded-xl shadow-2xl p-4 max-w-4xl mx-auto game-show-header header-glow">
            <div class="moving-lights">
                <div class="light"></div>
                <div class="light"></div>
                <div class="light"></div>
                <div class="light"></div>
                <div class="light"></div>
                <div class="light"></div>
                <div class="light"></div>
                <div class="light"></div>
                <div class="light"></div>
                <div class="light"></div>
            </div>
            <div class="bg-white/10 backdrop-blur-sm rounded-lg p-3 border border-white/20 relative z-10">
                <h1 class="text-2xl font-bold text-white mb-1 drop-shadow-lg">
                    <i class="fas fa-mosque text-yellow-300 mr-2 text-2xl"></i>
                    Game Show Cerdas Cermat Maulid Nabi Muhammad
                </h1>
                <p class="text-white text-lg arabic-text drop-shadow-md">صلى الله عليه وسلم</p>
            </div>
        </div>



        <!-- Settings Page -->
        <div id="settingsPage" class="max-w-4xl mx-auto">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6">
                    <i class="fas fa-cog text-emerald-500 mr-2"></i>Pengaturan Game
                </h2>
                
                <!-- Title & Subtitle Settings -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">Pengaturan Judul & Subtitle</h3>
                    <div class="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-lg p-6 border border-emerald-200">
                        <div class="grid md:grid-cols-1 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-2">
                                    <i class="fas fa-heading text-emerald-500 mr-1"></i>Judul Utama
                                </label>
                                <input type="text" id="mainTitle" value="Game Show Cerdas Cermat Maulid Nabi Muhammad" 
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"
                                       placeholder="Masukkan judul utama aplikasi">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-2">
                                    <i class="fas fa-quote-right text-emerald-500 mr-1"></i>Subtitle (Bahasa Arab/Latin)
                                </label>
                                <input type="text" id="subtitle" value="صلى الله عليه وسلم" 
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 arabic-text"
                                       placeholder="Masukkan subtitle (mendukung teks Arab)">
                                <p class="text-xs text-gray-500 mt-1">
                                    <strong>Contoh untuk mata pelajaran lain:</strong><br>
                                    • Matematika: "Mari Belajar dengan Menyenangkan"<br>
                                    • Bahasa Arab: "تعلم اللغة العربية بالمرح"<br>
                                    • IPA: "Eksplorasi Sains Bersama"<br>
                                    • Sejarah: "Mengenal Masa Lalu untuk Masa Depan"
                                </p>
                            </div>
                        </div>
                        <div class="mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                            <div class="flex items-start">
                                <i class="fas fa-info-circle text-blue-500 mr-2 mt-1"></i>
                                <div>
                                    <p class="text-sm text-blue-800 font-medium">Tips Penggunaan:</p>
                                    <p class="text-sm text-blue-700">
                                        Sesuaikan judul dan subtitle dengan mata pelajaran atau topik yang akan diajarkan. 
                                        Aplikasi ini dapat digunakan untuk semua mata pelajaran di kelas!
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Team Settings -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">Pengaturan Tim</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-600 mb-2">Jumlah Tim</label>
                            <input type="number" id="teamCount" min="2" max="8" value="5" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-600 mb-2">Timer Default (detik)</label>
                            <input type="number" id="defaultTimer" min="10" max="300" value="30" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                        </div>
                    </div>
                    
                    <div id="teamNames" class="mt-6 grid md:grid-cols-2 gap-4">
                        <!-- Team name inputs will be generated here -->
                    </div>
                    
                    <button id="generateTeams" class="mt-4 bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                        <i class="fas fa-users mr-2"></i>Generate Input Tim
                    </button>
                </div>

                <!-- Game Mode Settings -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">Mode Permainan</h3>
                    <div class="bg-gradient-to-r from-blue-50 to-green-50 rounded-lg p-6 border border-blue-200">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-4">
                                <div>
                                    <input type="radio" id="manualMode" name="gameMode" value="manual" checked class="mr-3">
                                    <label for="manualMode" class="text-lg font-semibold text-blue-700">
                                        <i class="fas fa-hand-paper mr-2"></i>Mode Manual
                                    </label>
                                    <p class="text-sm text-gray-600 ml-6 mt-1">
                                        • Host pilih tim secara manual<br>
                                        • Timer manual start/stop<br>
                                        • Skor sesuai nilai soal<br>
                                        • <strong>Cocok untuk babak rebutan/buzzer</strong>
                                    </p>
                                </div>
                            </div>
                            <div class="space-y-4">
                                <div>
                                    <input type="radio" id="autoMode" name="gameMode" value="auto" class="mr-3">
                                    <label for="autoMode" class="text-lg font-semibold text-green-700">
                                        <i class="fas fa-robot mr-2"></i>Mode Otomatis
                                    </label>
                                    <p class="text-sm text-gray-600 ml-6 mt-1">
                                        • Giliran tim otomatis berurutan<br>
                                        • Timer otomatis start setiap soal<br>
                                        • Skor tetap: Benar +100, Salah -50<br>
                                        • <strong>Cocok untuk babak biasa/reguler</strong>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                            <div class="flex items-start">
                                <i class="fas fa-lightbulb text-yellow-500 mr-2 mt-1"></i>
                                <div>
                                    <p class="text-sm text-yellow-800 font-medium">Tips Penggunaan:</p>
                                    <p class="text-sm text-yellow-700">
                                        <strong>Babak Biasa:</strong> Gunakan Mode Otomatis untuk pertanyaan bergiliran<br>
                                        <strong>Babak Rebutan:</strong> Gunakan Mode Manual untuk kontrol penuh host
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question Type Settings -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">Tipe Soal</h3>
                    <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-6 border border-purple-200">
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="space-y-4">
                                <div>
                                    <input type="radio" id="multipleChoiceType" name="questionType" value="multiple-choice" checked class="mr-3">
                                    <label for="multipleChoiceType" class="text-lg font-semibold text-purple-700">
                                        <i class="fas fa-list-ul mr-2"></i>Multiple Choice
                                    </label>
                                    <p class="text-sm text-gray-600 ml-6 mt-1">
                                        • Menampilkan 4 pilihan jawaban (A, B, C, D)<br>
                                        • Opsi jawaban diacak otomatis<br>
                                        • Peserta pilih salah satu jawaban<br>
                                        • <strong>Cocok untuk soal objektif</strong>
                                    </p>
                                </div>
                            </div>
                            <div class="space-y-4">
                                <div>
                                    <input type="radio" id="responseType" name="questionType" value="response" class="mr-3">
                                    <label for="responseType" class="text-lg font-semibold text-pink-700">
                                        <i class="fas fa-comment-dots mr-2"></i>Response
                                    </label>
                                    <p class="text-sm text-gray-600 ml-6 mt-1">
                                        • Tidak menampilkan pilihan jawaban<br>
                                        • Peserta menjawab secara bebas<br>
                                        • Host menilai jawaban manual<br>
                                        • <strong>Cocok untuk soal essay/uraian</strong>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="mt-4 p-4 bg-indigo-50 border border-indigo-200 rounded-lg">
                            <div class="flex items-start">
                                <i class="fas fa-info-circle text-indigo-500 mr-2 mt-1"></i>
                                <div>
                                    <p class="text-sm text-indigo-800 font-medium">Catatan Penting:</p>
                                    <p class="text-sm text-indigo-700">
                                        <strong>Multiple Choice:</strong> Pastikan soal memiliki 4 pilihan jawaban (A, B, C, D)<br>
                                        <strong>Response:</strong> Soal dapat berupa pertanyaan terbuka atau essay
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question Import -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">Import Soal</h3>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                        <i class="fas fa-file-excel text-4xl text-emerald-500 mb-4"></i>
                        <p class="text-gray-600 mb-4">Upload file Excel berisi soal-soal</p>
                        <input type="file" id="excelFile" accept=".xlsx,.xls" class="hidden">
                        <button id="uploadBtn" class="bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                            <i class="fas fa-upload mr-2"></i>Pilih File Excel
                        </button>
                        <p class="text-sm text-gray-500 mt-2">
                            <strong>Format Excel:</strong><br>
                            A=Kategori, B=Pertanyaan, C=Jawaban, D=Skor, E=URL Gambar<br>
                            <strong>Multiple Choice:</strong> F=Pilihan A, G=Pilihan B, H=Pilihan C, I=Pilihan D, J=Jawaban Benar (A/B/C/D)
                        </p>
                    </div>
                    <div id="questionPreview" class="mt-4 hidden">
                        <h4 class="font-medium text-gray-700 mb-2">Preview Soal:</h4>
                        <div class="bg-gray-50 rounded-lg p-4 max-h-40 overflow-y-auto">
                            <div id="questionList"></div>
                        </div>
                    </div>
                </div>

                <!-- Manual Question Input -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-4">Tambah Soal Manual</h3>
                    <div class="grid gap-4">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-2">Kategori</label>
                                <input type="text" id="manualCategory" placeholder="Contoh: Kelahiran Nabi" 
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-2">Skor</label>
                                <input type="number" id="manualScore" min="50" max="500" value="100" 
                                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-600 mb-2">Pertanyaan</label>
                            <textarea id="manualQuestion" placeholder="Masukkan soal (mendukung teks Arab + Latin)" 
                                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 mixed-text" 
                                      rows="3"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-600 mb-2">Jawaban (Opsional)</label>
                            <textarea id="manualAnswer" placeholder="Masukkan kunci jawaban (opsional)" 
                                      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 mixed-text" 
                                      rows="2"></textarea>
                        </div>
                        
                        <!-- Multiple Choice Options -->
                        <div id="multipleChoiceOptions" class="space-y-4">
                            <h4 class="text-md font-semibold text-gray-700">Pilihan Jawaban Multiple Choice</h4>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-600 mb-2">Pilihan A</label>
                                    <input type="text" id="optionA" placeholder="Masukkan pilihan A" 
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 mixed-text">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-600 mb-2">Pilihan B</label>
                                    <input type="text" id="optionB" placeholder="Masukkan pilihan B" 
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 mixed-text">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-600 mb-2">Pilihan C</label>
                                    <input type="text" id="optionC" placeholder="Masukkan pilihan C" 
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 mixed-text">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-600 mb-2">Pilihan D</label>
                                    <input type="text" id="optionD" placeholder="Masukkan pilihan D" 
                                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 mixed-text">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-2">Jawaban Benar</label>
                                <select id="correctAnswer" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                                    <option value="A">A</option>
                                    <option value="B">B</option>
                                    <option value="C">C</option>
                                    <option value="D">D</option>
                                </select>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-600 mb-2">URL Gambar (Opsional)</label>
                            <input type="url" id="manualImageUrl" placeholder="https://example.com/image.jpg" 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                            <p class="text-xs text-gray-500 mt-1">Masukkan URL gambar yang ingin ditampilkan bersama soal</p>
                        </div>
                        <button id="addQuestion" class="bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                            <i class="fas fa-plus mr-2"></i>Tambah Soal
                        </button>
                    </div>
                </div>

                <button id="startQuiz" class="w-full bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white py-4 rounded-lg font-bold text-lg transition-all duration-200 transform hover:scale-105">
                    <i class="fas fa-play mr-2"></i>Mulai Quiz
                </button>
            </div>
        </div>

        <!-- Quiz Page -->
        <div id="quizPage" class="hidden">
            <!-- Scoreboard - Ultra Compact -->
            <div class="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl shadow-lg p-3 mb-6 max-w-4xl mx-auto">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="text-sm font-bold text-white flex items-center">
                        <i class="fas fa-trophy text-yellow-300 mr-1"></i>Scoreboard
                    </h3>
                    <button id="resetScores" class="bg-white/20 hover:bg-white/30 text-white px-3 py-1 rounded font-medium transition-colors text-xs">
                        <i class="fas fa-redo mr-1"></i>Reset
                    </button>
                </div>
                <div id="scoreboard" class="grid grid-cols-5 gap-2">
                    <!-- Team scores will be generated here -->
                </div>
            </div>

            <!-- Question Container -->
            <div class="bg-white rounded-xl shadow-lg overflow-hidden mb-6 max-w-4xl mx-auto">
                <!-- Question Header -->
                <div class="bg-gradient-to-r from-emerald-50 to-teal-50 px-8 py-4 border-b border-emerald-100">
                    <div class="flex items-center justify-between mb-3">
                        <span id="categoryDisplay" class="bg-purple-500 text-white px-4 py-2 rounded-full text-sm font-medium">
                            Kategori: Maulid Nabi
                        </span>
                        <span class="bg-emerald-500 text-white px-4 py-2 rounded-full text-lg font-bold">
                            Soal <span id="currentQuestionNumber">1</span> dari <span id="totalQuestions">0</span>
                        </span>
                        <span id="scoreDisplay" class="bg-orange-500 text-white px-4 py-2 rounded-full text-sm font-medium">
                            Point: 100
                        </span>
                    </div>
                    
                    <!-- Mode Status Display -->
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-4">
                            <div id="modeDisplay" class="flex items-center gap-2">
                                <span class="text-sm font-medium text-gray-700">Mode:</span>
                                <span id="currentModeDisplay" class="bg-blue-500 text-white px-3 py-1 rounded-full text-sm font-medium">
                                    <i class="fas fa-hand-paper mr-1"></i>Manual
                                </span>
                            </div>
                            <div id="autoModeStatus" class="hidden text-sm">
                                <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full">
                                    <i class="fas fa-robot mr-1"></i>Giliran: <span id="currentTeamName">-</span>
                                </span>
                            </div>
                        </div>
                        
                        <div class="flex items-center gap-2">
                            <button id="pauseAutoBtn" class="hidden bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-2 rounded-lg font-medium transition-colors text-sm">
                                <i class="fas fa-pause mr-1"></i>Pause
                            </button>
                            <button id="nextAutoBtn" class="hidden bg-emerald-500 hover:bg-emerald-600 text-white px-3 py-2 rounded-lg font-medium transition-colors text-sm">
                                <i class="fas fa-forward mr-1"></i>Skip
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Question Content -->
                <div id="questionContainer" class="timer-container p-8 bg-gradient-to-br from-gray-800 via-gray-900 to-black">
                    <div id="timerBorder" class="timer-border">
                        <div id="sweep" class="sweep"></div>
                    </div>
                    <div id="sparkle" class="sparkle"></div>
                    <div id="questionContent" class="question-content text-white font-medium drop-shadow-lg relative z-10">
                        <div id="questionText" class="text-3xl mixed-text leading-relaxed question-text-only">
                            Pilih tim untuk memulai soal pertama
                        </div>
                        <div id="questionImageContainer" class="hidden">
                            <img id="questionImage" class="question-image" alt="Gambar soal" onerror="this.style.display='none'; document.getElementById('imageError').style.display='block';">
                            <div id="imageError" class="hidden text-red-300 text-sm bg-red-900/30 px-4 py-2 rounded-lg">
                                <i class="fas fa-exclamation-triangle mr-2"></i>Gambar gagal dimuat
                            </div>
                        </div>
                        
                        <!-- Multiple Choice Options Display -->
                        <div id="multipleChoiceDisplay" class="hidden w-full max-w-2xl">
                            <div class="grid grid-cols-1 gap-3 mt-6">
                                <button id="choiceA" class="choice-button bg-blue-600 hover:bg-blue-700 text-white p-4 rounded-lg text-left font-medium transition-all duration-200 transform hover:scale-105 shadow-lg">
                                    <span class="choice-letter bg-white text-blue-600 px-3 py-1 rounded-full font-bold mr-3">A</span>
                                    <span class="choice-text"></span>
                                </button>
                                <button id="choiceB" class="choice-button bg-green-600 hover:bg-green-700 text-white p-4 rounded-lg text-left font-medium transition-all duration-200 transform hover:scale-105 shadow-lg">
                                    <span class="choice-letter bg-white text-green-600 px-3 py-1 rounded-full font-bold mr-3">B</span>
                                    <span class="choice-text"></span>
                                </button>
                                <button id="choiceC" class="choice-button bg-orange-600 hover:bg-orange-700 text-white p-4 rounded-lg text-left font-medium transition-all duration-200 transform hover:scale-105 shadow-lg">
                                    <span class="choice-letter bg-white text-orange-600 px-3 py-1 rounded-full font-bold mr-3">C</span>
                                    <span class="choice-text"></span>
                                </button>
                                <button id="choiceD" class="choice-button bg-purple-600 hover:bg-purple-700 text-white p-4 rounded-lg text-left font-medium transition-all duration-200 transform hover:scale-105 shadow-lg">
                                    <span class="choice-letter bg-white text-purple-600 px-3 py-1 rounded-full font-bold mr-3">D</span>
                                    <span class="choice-text"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Navigation -->
                <div class="bg-gray-50 px-8 py-4">
                    <div class="flex justify-between items-center mb-4">
                        <button id="prevQuestion" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                            <i class="fas fa-chevron-left mr-2"></i>Sebelumnya
                        </button>
                        <button id="showAnswerBtn" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-3 rounded-lg font-medium transition-colors text-lg">
                            <i class="fas fa-key"></i>
                        </button>
                        <button id="nextQuestion" class="bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                            <i class="fas fa-chevron-right mr-2"></i>Selanjutnya
                        </button>
                    </div>
                    <div id="answerDisplay" class="hidden bg-blue-50 border-l-4 border-blue-500 p-4 rounded-lg">
                        <h4 class="font-bold text-blue-800 mb-2">
                            <i class="fas fa-key mr-2"></i>Kunci Jawaban:
                        </h4>
                        <div id="answerText" class="mixed-text text-blue-900 text-lg"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let teams = [];
        let gameMode = 'manual'; // 'manual' or 'auto'
        let questionType = 'multiple-choice'; // 'multiple-choice' or 'response'
        let currentTeamTurn = 0;
        let autoTimer = null;
        let isAutoPaused = false;
        let appTitle = "Game Show Cerdas Cermat Maulid Nabi Muhammad";
        let appSubtitle = "صلى الله عليه وسلم";
        let questions = [
            {
                id: 1,
                category: "Kelahiran Nabi",
                text: "متى وُلد النبي محمد صلى الله عليه وسلم؟ Kapan Nabi Muhammad SAW dilahirkan?",
                answer: "12 Rabiul Awwal tahun Gajah (571 M) - عام الفيل",
                score: 100,
                imageUrl: "",
                type: "multiple-choice",
                options: {
                    A: "12 Rabiul Awwal tahun Gajah (571 M)",
                    B: "17 Ramadan tahun Gajah (570 M)",
                    C: "1 Muharram tahun Gajah (572 M)",
                    D: "15 Syaban tahun Gajah (569 M)"
                },
                correctAnswer: "A"
            },
            {
                id: 2,
                category: "Keluarga Nabi",
                text: "ما اسم أم النبي محمد صلى الله عليه وسلم؟ Siapa nama ibu Nabi Muhammad SAW?",
                answer: "Aminah binti Wahab - آمنة بنت وهب",
                score: 150,
                imageUrl: "",
                type: "multiple-choice",
                options: {
                    A: "Khadijah binti Khuwailid",
                    B: "Aminah binti Wahab",
                    C: "Fatimah binti Asad",
                    D: "Halimah As-Sa'diyah"
                },
                correctAnswer: "B"
            },
            {
                id: 3,
                category: "Kelahiran Nabi",
                text: "في أي مدينة وُلد النبي صلى الله عليه وسلم؟ Di kota mana Nabi SAW dilahirkan?",
                answer: "Makkah Al-Mukarramah - مكة المكرمة",
                score: 100,
                imageUrl: "",
                type: "multiple-choice",
                options: {
                    A: "Madinah Al-Munawwarah",
                    B: "Makkah Al-Mukarramah",
                    C: "Thaif",
                    D: "Yaman"
                },
                correctAnswer: "B"
            },
            {
                id: 4,
                category: "Keluarga Nabi",
                text: "ما اسم جد النبي محمد صلى الله عليه وسلم؟ Siapa nama kakek Nabi Muhammad SAW?",
                answer: "Abdul Muthalib - عبد المطلب",
                score: 200,
                imageUrl: "",
                type: "multiple-choice",
                options: {
                    A: "Abdul Muthalib",
                    B: "Abdullah",
                    C: "Abu Thalib",
                    D: "Hashim"
                },
                correctAnswer: "A"
            },
            {
                id: 5,
                category: "Keluarga Nabi",
                text: "كم كان عمر النبي صلى الله عليه وسلم عندما توفي والده؟ Berapa usia Nabi SAW ketika ayahnya meninggal?",
                answer: "Belum lahir (masih dalam kandungan) - لم يولد بعد",
                score: 250,
                imageUrl: "",
                type: "multiple-choice",
                options: {
                    A: "2 tahun",
                    B: "6 tahun",
                    C: "Belum lahir (dalam kandungan)",
                    D: "1 tahun"
                },
                correctAnswer: "C"
            },
            {
                id: 6,
                category: "Masa Kecil",
                text: "ما اسم المرضعة التي أرضعت النبي صلى الله عليه وسلم؟ Siapa nama ibu susuan Nabi SAW?",
                answer: "Halimah As-Sa'diyah - حليمة السعدية",
                score: 200,
                imageUrl: "",
                type: "multiple-choice",
                options: {
                    A: "Aminah binti Wahab",
                    B: "Halimah As-Sa'diyah",
                    C: "Barakah Ummu Aiman",
                    D: "Khadijah binti Khuwailid"
                },
                correctAnswer: "B"
            },
            {
                id: 7,
                category: "Kenabian",
                text: "في أي عام حدثت بعثة النبي صلى الله عليه وسلم؟ Pada tahun berapa Nabi SAW diutus menjadi Rasul?",
                answer: "610 M (usia 40 tahun) - عام ٦١٠ م",
                score: 300,
                imageUrl: "",
                type: "multiple-choice",
                options: {
                    A: "610 M (usia 40 tahun)",
                    B: "620 M (usia 50 tahun)",
                    C: "600 M (usia 30 tahun)",
                    D: "571 M (saat lahir)"
                },
                correctAnswer: "A"
            },
            {
                id: 8,
                category: "Kenabian",
                text: "ما اسم الغار الذي كان يتعبد فيه النبي صلى الله عليه وسلم؟ Apa nama gua tempat Nabi SAW beribadah?",
                answer: "Gua Hira - غار حراء",
                score: 250,
                imageUrl: "",
                type: "multiple-choice",
                options: {
                    A: "Gua Tsur",
                    B: "Gua Hira",
                    C: "Gua Uhud",
                    D: "Gua Quba"
                },
                correctAnswer: "B"
            },
            {
                id: 9,
                category: "Sahabat Nabi",
                text: "من هو أول من آمن بالنبي صلى الله عليه وسلم من الرجال؟ Siapa laki-laki pertama yang beriman kepada Nabi SAW?",
                answer: "Abu Bakar Ash-Shiddiq - أبو بكر الصديق",
                score: 200,
                imageUrl: "",
                type: "multiple-choice",
                options: {
                    A: "Abu Bakar Ash-Shiddiq",
                    B: "Umar bin Khattab",
                    C: "Utsman bin Affan",
                    D: "Ali bin Abi Thalib"
                },
                correctAnswer: "A"
            },
            {
                id: 10,
                category: "Visual Quiz",
                text: "مَا هَذَا؟ Apa ini?",
                answer: "Kitab/Buku - كِتَاب",
                score: 150,
                imageUrl: "https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop",
                type: "response"
            },
            {
                id: 11,
                category: "Hijrah",
                text: "إلى أين هاجر النبي صلى الله عليه وسلم؟ Ke mana Nabi SAW berhijrah?",
                answer: "Madinah Al-Munawwarah - المدينة المنورة",
                score: 200,
                imageUrl: "",
                type: "multiple-choice",
                options: {
                    A: "Thaif",
                    B: "Madinah Al-Munawwarah",
                    C: "Habasyah (Ethiopia)",
                    D: "Syam"
                },
                correctAnswer: "B"
            },
            {
                id: 12,
                category: "Akhlak Nabi",
                text: "ما هو لقب النبي محمد صلى الله عليه وسلم قبل البعثة؟ Apa gelar Nabi Muhammad SAW sebelum diutus?",
                answer: "Al-Amin (Yang Terpercaya) - الأمين",
                score: 150,
                imageUrl: "",
                type: "multiple-choice",
                options: {
                    A: "Al-Amin (Yang Terpercaya)",
                    B: "As-Shadiq (Yang Jujur)",
                    C: "Al-Mustafa (Yang Terpilih)",
                    D: "Ar-Rasul (Utusan)"
                },
                correctAnswer: "A"
            }
        ];
        let currentQuestionIndex = 0;
        let activeTeam = null;
        let timer = null;
        let timeLeft = 30;
        let defaultTime = 30;

        // DOM elements
        const settingsPage = document.getElementById('settingsPage');
        const quizPage = document.getElementById('quizPage');
        const teamCountInput = document.getElementById('teamCount');
        const defaultTimerInput = document.getElementById('defaultTimer');
        const teamNamesDiv = document.getElementById('teamNames');
        const generateTeamsBtn = document.getElementById('generateTeams');
        const excelFile = document.getElementById('excelFile');
        const uploadBtn = document.getElementById('uploadBtn');
        const questionPreview = document.getElementById('questionPreview');
        const questionList = document.getElementById('questionList');
        const manualCategory = document.getElementById('manualCategory');
        const manualQuestion = document.getElementById('manualQuestion');
        const manualAnswer = document.getElementById('manualAnswer');
        const manualScore = document.getElementById('manualScore');
        const manualImageUrl = document.getElementById('manualImageUrl');
        const addQuestionBtn = document.getElementById('addQuestion');
        const startQuizBtn = document.getElementById('startQuiz');
        const questionContainer = document.getElementById('questionContainer');
        const questionContent = document.getElementById('questionContent');
        const questionText = document.getElementById('questionText');
        const questionImageContainer = document.getElementById('questionImageContainer');
        const questionImage = document.getElementById('questionImage');
        const currentQuestionNumber = document.getElementById('currentQuestionNumber');
        const totalQuestions = document.getElementById('totalQuestions');
        const categoryDisplay = document.getElementById('categoryDisplay');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const scoreboard = document.getElementById('scoreboard');
        const prevQuestionBtn = document.getElementById('prevQuestion');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const resetScoresBtn = document.getElementById('resetScores');
        const showAnswerBtn = document.getElementById('showAnswerBtn');
        const answerDisplay = document.getElementById('answerDisplay');
        const answerText = document.getElementById('answerText');
        const timerBorder = document.getElementById('timerBorder');
        const sweepEl = document.getElementById('sweep');
        const sparkle = document.getElementById('sparkle');
        const currentModeDisplay = document.getElementById('currentModeDisplay');
        const autoModeStatus = document.getElementById('autoModeStatus');
        const currentTeamName = document.getElementById('currentTeamName');
        const pauseAutoBtn = document.getElementById('pauseAutoBtn');
        const nextAutoBtn = document.getElementById('nextAutoBtn');
        const manualModeRadio = document.getElementById('manualMode');
        const autoModeRadio = document.getElementById('autoMode');
        const multipleChoiceTypeRadio = document.getElementById('multipleChoiceType');
        const responseTypeRadio = document.getElementById('responseType');
        const multipleChoiceOptions = document.getElementById('multipleChoiceOptions');
        const mainTitleInput = document.getElementById('mainTitle');
        const subtitleInput = document.getElementById('subtitle');
        const optionA = document.getElementById('optionA');
        const optionB = document.getElementById('optionB');
        const optionC = document.getElementById('optionC');
        const optionD = document.getElementById('optionD');
        const correctAnswerSelect = document.getElementById('correctAnswer');
        const multipleChoiceDisplay = document.getElementById('multipleChoiceDisplay');
        const choiceA = document.getElementById('choiceA');
        const choiceB = document.getElementById('choiceB');
        const choiceC = document.getElementById('choiceC');
        const choiceD = document.getElementById('choiceD');

        // Initialize
        generateTeamInputs();
        updateQuestionPreview();
        loadGameState();
        toggleQuestionTypeOptions();

        // Event listeners
        teamCountInput.addEventListener('change', generateTeamInputs);
        defaultTimerInput.addEventListener('change', updateDefaultTimer);
        generateTeamsBtn.addEventListener('click', generateTeamInputs);
        uploadBtn.addEventListener('click', () => excelFile.click());
        excelFile.addEventListener('change', handleExcelUpload);
        addQuestionBtn.addEventListener('click', addManualQuestion);
        startQuizBtn.addEventListener('click', startQuiz);
        prevQuestionBtn.addEventListener('click', () => changeQuestion(-1));
        nextQuestionBtn.addEventListener('click', () => changeQuestion(1));
        resetScoresBtn.addEventListener('click', resetAllScores);
        showAnswerBtn.addEventListener('click', showAnswer);
        pauseAutoBtn.addEventListener('click', toggleAutoPause);
        nextAutoBtn.addEventListener('click', skipToNextQuestion);
        multipleChoiceTypeRadio.addEventListener('change', toggleQuestionTypeOptions);
        responseTypeRadio.addEventListener('change', toggleQuestionTypeOptions);
        mainTitleInput.addEventListener('input', updateAppTitle);
        subtitleInput.addEventListener('input', updateAppSubtitle);
        
        // Multiple choice button listeners
        choiceA.addEventListener('click', () => handleChoiceClick('A'));
        choiceB.addEventListener('click', () => handleChoiceClick('B'));
        choiceC.addEventListener('click', () => handleChoiceClick('C'));
        choiceD.addEventListener('click', () => handleChoiceClick('D'));

        function switchToQuiz() {
            settingsPage.classList.add('hidden');
            quizPage.classList.remove('hidden');
        }

        function toggleQuestionTypeOptions() {
            if (multipleChoiceTypeRadio.checked) {
                multipleChoiceOptions.classList.remove('hidden');
            } else {
                multipleChoiceOptions.classList.add('hidden');
            }
        }

        function updateAppTitle() {
            appTitle = mainTitleInput.value.trim() || "Game Show Cerdas Cermat";
            updateHeaderDisplay();
            saveGameState();
        }

        function updateAppSubtitle() {
            appSubtitle = subtitleInput.value.trim() || "";
            updateHeaderDisplay();
            saveGameState();
        }

        function updateHeaderDisplay() {
            const headerTitle = document.querySelector('h1');
            const headerSubtitle = document.querySelector('.arabic-text');
            
            if (headerTitle) {
                headerTitle.innerHTML = `<i class="fas fa-mosque text-yellow-300 mr-2 text-2xl"></i>${appTitle}`;
            }
            
            if (headerSubtitle) {
                if (appSubtitle) {
                    headerSubtitle.textContent = appSubtitle;
                    headerSubtitle.style.display = 'block';
                } else {
                    headerSubtitle.style.display = 'none';
                }
            }
        }

        function handleChoiceClick(displayLetter) {
            // Only allow choice selection if there's an active team (manual mode) or in auto mode
            if (gameMode === 'manual' && !activeTeam) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Pilih Tim Dulu!',
                    text: 'Silakan pilih tim yang akan menjawab',
                    confirmButtonColor: '#f59e0b'
                });
                return;
            }

            const currentQuestion = questions[currentQuestionIndex];
            if (!currentQuestion || currentQuestion.type !== 'multiple-choice') return;

            // Find which button was clicked and get its original letter
            const clickedButton = document.getElementById(`choice${displayLetter}`);
            const originalLetter = clickedButton.getAttribute('data-original-letter');
            
            // Check if answer is correct
            const isCorrect = originalLetter === currentQuestion.correctAnswer;
            
            // Visual feedback
            const allChoices = [choiceA, choiceB, choiceC, choiceD];
            allChoices.forEach(choice => {
                choice.style.pointerEvents = 'none'; // Disable all buttons
                const choiceOriginalLetter = choice.getAttribute('data-original-letter');
                
                if (choiceOriginalLetter === currentQuestion.correctAnswer) {
                    // Highlight correct answer in green
                    choice.classList.remove('bg-blue-600', 'bg-green-600', 'bg-orange-600', 'bg-purple-600');
                    choice.classList.add('bg-green-500');
                } else if (choice === clickedButton && !isCorrect) {
                    // Highlight wrong selected answer in red
                    choice.classList.remove('bg-blue-600', 'bg-green-600', 'bg-orange-600', 'bg-purple-600');
                    choice.classList.add('bg-red-500');
                }
            });

            // Calculate points
            let points;
            if (gameMode === 'auto') {
                points = isCorrect ? 100 : -50;
            } else {
                points = isCorrect ? currentQuestion.score : -Math.floor(currentQuestion.score * 0.5);
            }

            // Get active team
            let teamToUpdate;
            if (gameMode === 'auto') {
                teamToUpdate = teams[currentTeamTurn];
            } else {
                teamToUpdate = teams.find(t => t.id === activeTeam);
            }

            if (teamToUpdate) {
                // Update score
                teamToUpdate.score = Math.max(0, teamToUpdate.score + points);
                
                // Stop timer
                clearInterval(timer);
                resetTimerBorder();
                timeLeft = defaultTime;
                
                generateScoreboard();
                saveGameState();
                
                const resultText = isCorrect ? 'Benar!' : 'Salah!';
                const resultIcon = isCorrect ? 'success' : 'error';
                
                Swal.fire({
                    icon: resultIcon,
                    title: resultText,
                    text: `${teamToUpdate.name} ${points > 0 ? '+' : ''}${points} poin`,
                    timer: 2000,
                    showConfirmButton: false
                }).then(() => {
                    // Re-enable buttons after feedback
                    allChoices.forEach(choice => {
                        choice.style.pointerEvents = 'auto';
                    });
                    
                    // Reset button colors for next question
                    resetChoiceButtonColors();
                });

                // In auto mode, automatically move to next team after scoring
                if (gameMode === 'auto' && !isAutoPaused) {
                    setTimeout(() => {
                        currentTeamTurn = (currentTeamTurn + 1) % teams.length;
                        
                        // If we've completed a full round, move to next question
                        if (currentTeamTurn === 0) {
                            changeQuestion(1);
                        } else {
                            startAutoMode();
                        }
                    }, 2500); // Wait 2.5 seconds after scoring
                }
            }
        }

        function resetChoiceButtonColors() {
            const choices = [choiceA, choiceB, choiceC, choiceD];
            const colors = [
                'bg-blue-600 hover:bg-blue-700',
                'bg-green-600 hover:bg-green-700', 
                'bg-orange-600 hover:bg-orange-700',
                'bg-purple-600 hover:bg-purple-700'
            ];
            
            choices.forEach((choice, index) => {
                choice.className = `choice-button ${colors[index]} text-white p-4 rounded-lg text-left font-medium transition-all duration-200 transform hover:scale-105 shadow-lg`;
                choice.style.pointerEvents = 'auto';
            });
        }



        function startAutoMode() {
            if (teams.length === 0) return;
            
            // Select current team
            const currentTeam = teams[currentTeamTurn];
            currentTeamName.textContent = currentTeam.name;
            activeTeam = currentTeam.id;
            
            // Update team button styles
            document.querySelectorAll('.team-button').forEach((btn, index) => {
                btn.classList.remove('bg-emerald-200');
                if (index === currentTeamTurn) {
                    btn.classList.add('bg-emerald-200');
                }
            });
            
            // Start timer automatically
            if (!isAutoPaused) {
                clearInterval(timer);
                timeLeft = defaultTime;
                startTimer();
            }
        }

        function stopAutoMode() {
            clearInterval(autoTimer);
            clearInterval(timer);
            resetTimerBorder();
            isAutoPaused = false;
            activeTeam = null;
            
            // Reset team button styles
            document.querySelectorAll('.team-button').forEach(btn => {
                btn.classList.remove('bg-emerald-200');
            });
        }

        function toggleAutoPause() {
            isAutoPaused = !isAutoPaused;
            
            if (isAutoPaused) {
                clearInterval(timer);
                resetTimerBorder();
                pauseAutoBtn.innerHTML = '<i class="fas fa-play mr-1"></i>Resume';
                pauseAutoBtn.classList.remove('bg-yellow-500', 'hover:bg-yellow-600');
                pauseAutoBtn.classList.add('bg-green-500', 'hover:bg-green-600');
            } else {
                timeLeft = defaultTime;
                startTimer();
                pauseAutoBtn.innerHTML = '<i class="fas fa-pause mr-1"></i>Pause';
                pauseAutoBtn.classList.remove('bg-green-500', 'hover:bg-green-600');
                pauseAutoBtn.classList.add('bg-yellow-500', 'hover:bg-yellow-600');
            }
        }

        function skipToNextQuestion() {
            if (gameMode === 'auto') {
                // Move to next team
                currentTeamTurn = (currentTeamTurn + 1) % teams.length;
                
                // If we've completed a full round, move to next question
                if (currentTeamTurn === 0) {
                    changeQuestion(1);
                } else {
                    startAutoMode();
                }
            }
        }

        function generateTeamInputs() {
            const count = parseInt(teamCountInput.value);
            const defaultTeams = ['Tim Merah', 'Tim Biru', 'Tim Hijau', 'Tim Kuning', 'Tim Ungu', 'Tim Orange', 'Tim Pink', 'Tim Coklat'];
            teamNamesDiv.innerHTML = '';
            
            for (let i = 1; i <= count; i++) {
                const div = document.createElement('div');
                div.innerHTML = `
                    <label class="block text-sm font-medium text-gray-600 mb-2">Nama Tim ${i}</label>
                    <input type="text" id="team${i}" value="${defaultTeams[i-1] || `Tim ${i}`}" 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500">
                `;
                teamNamesDiv.appendChild(div);
            }
        }

        function updateDefaultTimer() {
            defaultTime = parseInt(defaultTimerInput.value);
            timeLeft = defaultTime;
        }

        function handleExcelUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                    
                    questions = [];
                    jsonData.forEach((row, index) => {
                        if (row[1] && row[1].toString().trim()) { // Column B for question
                            const questionData = {
                                id: Date.now() + index,
                                category: row[0] ? row[0].toString().trim() : 'Maulid Nabi',
                                text: row[1].toString().trim(),
                                answer: row[2] ? row[2].toString().trim() : '',
                                score: row[3] ? parseInt(row[3]) || 100 : 100,
                                imageUrl: row[4] ? row[4].toString().trim() : '',
                                type: 'response' // Default to response type for Excel import
                            };
                            
                            // Check if columns F, G, H, I exist for multiple choice options
                            if (row[5] && row[6] && row[7] && row[8]) {
                                questionData.type = 'multiple-choice';
                                questionData.options = {
                                    A: row[5].toString().trim(),
                                    B: row[6].toString().trim(),
                                    C: row[7].toString().trim(),
                                    D: row[8].toString().trim()
                                };
                                questionData.correctAnswer = row[9] ? row[9].toString().trim().toUpperCase() : 'A';
                            }
                            
                            questions.push(questionData);
                        }
                    });

                    updateQuestionPreview();
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'Berhasil!',
                        text: `${questions.length} soal berhasil diimport`,
                        confirmButtonColor: '#10b981'
                    });
                } catch (error) {
                    Swal.fire({
                        icon: 'error',
                        title: 'Error!',
                        text: 'Gagal membaca file Excel',
                        confirmButtonColor: '#ef4444'
                    });
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function addManualQuestion() {
            const questionContent = manualQuestion.value.trim();
            const categoryContent = manualCategory.value.trim() || 'Maulid Nabi';
            const answerContent = manualAnswer.value.trim();
            const scoreValue = parseInt(manualScore.value) || 100;
            const imageUrlContent = manualImageUrl.value.trim();
            const currentQuestionType = multipleChoiceTypeRadio.checked ? 'multiple-choice' : 'response';
            
            if (!questionContent) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Peringatan!',
                    text: 'Silakan masukkan soal terlebih dahulu',
                    confirmButtonColor: '#f59e0b'
                });
                return;
            }

            const questionData = {
                id: Date.now(),
                category: categoryContent,
                text: questionContent,
                answer: answerContent,
                score: scoreValue,
                imageUrl: imageUrlContent,
                type: currentQuestionType
            };

            // Add multiple choice options if selected
            if (currentQuestionType === 'multiple-choice') {
                const optionAValue = optionA.value.trim();
                const optionBValue = optionB.value.trim();
                const optionCValue = optionC.value.trim();
                const optionDValue = optionD.value.trim();
                
                if (!optionAValue || !optionBValue || !optionCValue || !optionDValue) {
                    Swal.fire({
                        icon: 'warning',
                        title: 'Peringatan!',
                        text: 'Silakan lengkapi semua pilihan jawaban A, B, C, D',
                        confirmButtonColor: '#f59e0b'
                    });
                    return;
                }
                
                questionData.options = {
                    A: optionAValue,
                    B: optionBValue,
                    C: optionCValue,
                    D: optionDValue
                };
                questionData.correctAnswer = correctAnswerSelect.value;
            }

            questions.push(questionData);

            // Clear form
            manualCategory.value = '';
            manualQuestion.value = '';
            manualAnswer.value = '';
            manualScore.value = '100';
            manualImageUrl.value = '';
            optionA.value = '';
            optionB.value = '';
            optionC.value = '';
            optionD.value = '';
            correctAnswerSelect.value = 'A';
            
            updateQuestionPreview();
            
            Swal.fire({
                icon: 'success',
                title: 'Berhasil!',
                text: 'Soal berhasil ditambahkan',
                confirmButtonColor: '#10b981'
            });
        }

        function updateQuestionPreview() {
            if (questions.length > 0) {
                questionPreview.classList.remove('hidden');
                questionList.innerHTML = questions.map((q, index) => {
                    const typeIcon = q.type === 'multiple-choice' ? 
                        '<i class="fas fa-list-ul mr-1"></i>Multiple Choice' : 
                        '<i class="fas fa-comment-dots mr-1"></i>Response';
                    const typeColor = q.type === 'multiple-choice' ? 
                        'bg-purple-100 text-purple-800' : 
                        'bg-pink-100 text-pink-800';
                    
                    return `<div class="mb-2 p-2 bg-white rounded border-l-4 border-emerald-500">
                        <div class="flex items-center justify-between mb-1">
                            <span class="font-medium text-emerald-600">${index + 1}.</span>
                            <div class="flex gap-2">
                                <span class="bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs">${q.category}</span>
                                <span class="${typeColor} px-2 py-1 rounded text-xs">${typeIcon}</span>
                                <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded text-xs">${q.score} poin</span>
                                ${q.imageUrl ? '<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs"><i class="fas fa-image mr-1"></i>Gambar</span>' : ''}
                            </div>
                        </div>
                        <span class="mixed-text">${q.text}</span>
                        ${q.type === 'multiple-choice' && q.options ? 
                            `<div class="mt-2 text-xs text-gray-600">
                                <div class="grid grid-cols-2 gap-1">
                                    <span>A: ${q.options.A}</span>
                                    <span>B: ${q.options.B}</span>
                                    <span>C: ${q.options.C}</span>
                                    <span>D: ${q.options.D}</span>
                                </div>
                                <span class="font-medium text-green-600">Jawaban: ${q.correctAnswer}</span>
                            </div>` : ''
                        }
                    </div>`;
                }).join('');
            } else {
                questionPreview.classList.add('hidden');
            }
        }

        function startQuiz() {
            // Collect team names
            teams = [];
            const teamCount = parseInt(teamCountInput.value);
            
            for (let i = 1; i <= teamCount; i++) {
                const teamName = document.getElementById(`team${i}`).value.trim() || `Tim ${i}`;
                teams.push({
                    id: i,
                    name: teamName,
                    score: 0
                });
            }

            if (questions.length === 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Peringatan!',
                    text: 'Silakan tambahkan soal terlebih dahulu',
                    confirmButtonColor: '#f59e0b'
                });
                return;
            }

            // Set game mode and question type from settings
            gameMode = autoModeRadio.checked ? 'auto' : 'manual';
            questionType = multipleChoiceTypeRadio.checked ? 'multiple-choice' : 'response';
            
            // Update mode display
            if (gameMode === 'auto') {
                currentModeDisplay.innerHTML = '<i class="fas fa-robot mr-1"></i>Otomatis';
                currentModeDisplay.classList.remove('bg-blue-500');
                currentModeDisplay.classList.add('bg-green-500');
                autoModeStatus.classList.remove('hidden');
                pauseAutoBtn.classList.remove('hidden');
                nextAutoBtn.classList.remove('hidden');
            } else {
                currentModeDisplay.innerHTML = '<i class="fas fa-hand-paper mr-1"></i>Manual';
                currentModeDisplay.classList.remove('bg-green-500');
                currentModeDisplay.classList.add('bg-blue-500');
                autoModeStatus.classList.add('hidden');
                pauseAutoBtn.classList.add('hidden');
                nextAutoBtn.classList.add('hidden');
            }

            // Switch to quiz page
            switchToQuiz();
            
            // Initialize quiz
            currentQuestionIndex = 0;
            currentTeamTurn = 0;
            updateQuestionDisplay();
            generateScoreboard();
            saveGameState();
            
            // Start auto mode if selected
            if (gameMode === 'auto') {
                startAutoMode();
            }
            
            const modeText = gameMode === 'auto' ? 'Mode Otomatis - Giliran tim otomatis' : 'Mode Manual - Klik nama tim untuk memulai';
            
            Swal.fire({
                icon: 'success',
                title: 'Quiz Dimulai!',
                text: modeText,
                confirmButtonColor: '#10b981'
            });
        }

        function generateScoreboard() {
            const teamColors = [
                { bg: 'bg-red-500', hover: 'hover:bg-red-600', text: 'text-white' },
                { bg: 'bg-blue-500', hover: 'hover:bg-blue-600', text: 'text-white' },
                { bg: 'bg-green-500', hover: 'hover:bg-green-600', text: 'text-white' },
                { bg: 'bg-yellow-500', hover: 'hover:bg-yellow-600', text: 'text-black' },
                { bg: 'bg-purple-500', hover: 'hover:bg-purple-600', text: 'text-white' },
                { bg: 'bg-orange-500', hover: 'hover:bg-orange-600', text: 'text-white' },
                { bg: 'bg-pink-500', hover: 'hover:bg-pink-600', text: 'text-white' },
                { bg: 'bg-amber-600', hover: 'hover:bg-amber-700', text: 'text-white' }
            ];
            
            scoreboard.innerHTML = teams.map((team, index) => {
                const color = teamColors[index] || teamColors[0];
                
                // Auto mode uses fixed scoring: +100 correct, -50 wrong
                // Manual mode uses question-based scoring
                let correctPoints, wrongPoints;
                if (gameMode === 'auto') {
                    correctPoints = 100;
                    wrongPoints = 50;
                } else {
                    const currentQuestion = questions[currentQuestionIndex];
                    correctPoints = currentQuestion ? currentQuestion.score : 100;
                    wrongPoints = Math.floor(correctPoints * 0.5); // 50% penalty
                }
                
                const teamButtonDisabled = gameMode === 'auto' ? 'pointer-events-none opacity-75' : '';
                
                return `
                <div class="${color.bg} rounded-lg p-2 shadow-lg border-2 border-white/30">
                    <button onclick="selectTeam(${team.id})" 
                            class="team-button w-full text-center font-bold ${color.text} ${color.hover} transition-colors mb-1 text-xs truncate py-1 rounded ${teamButtonDisabled}">
                        ${team.name}
                    </button>
                    <div class="flex items-center justify-between mb-1">
                        <button onclick="updateScore(${team.id}, -${wrongPoints})" 
                                class="bg-red-600 hover:bg-red-700 text-white w-6 h-6 rounded-full text-xs font-bold transition-colors flex items-center justify-center shadow-md">
                            -
                        </button>
                        <span class="text-xl font-bold text-white mx-1 drop-shadow-lg">${team.score}</span>
                        <button onclick="updateScore(${team.id}, ${correctPoints})" 
                                class="bg-green-600 hover:bg-green-700 text-white w-6 h-6 rounded-full text-xs font-bold transition-colors flex items-center justify-center shadow-md">
                            +
                        </button>
                    </div>
                </div>
            `;
            }).join('');
        }

        function selectTeam(teamId) {
            // Only allow manual team selection in manual mode
            if (gameMode === 'auto') return;
            
            activeTeam = teamId;
            const team = teams.find(t => t.id === teamId);
            
            // Reset and start timer
            clearInterval(timer);
            timeLeft = defaultTime;
            startTimer();
            
            // Update team button styles
            document.querySelectorAll('.team-button').forEach(btn => {
                btn.classList.remove('bg-emerald-200');
            });
            event.target.classList.add('bg-emerald-200');
            
            Swal.fire({
                icon: 'info',
                title: `${team.name} Aktif!`,
                text: 'Timer dimulai, silakan jawab soal',
                timer: 2000,
                showConfirmButton: false
            });
        }

        let timerStart = null;
        let timerAnimationId = null;

        function startTimer() {
            timerBorder.classList.add('active');
            sparkle.classList.remove('active');
            timerStart = performance.now();
            
            function animateTimer(timestamp) {
                if (!timerStart) timerStart = timestamp;
                const elapsed = (timestamp - timerStart) / 1000;
                const progress = Math.min(elapsed / defaultTime, 1);
                const angle = progress * 360;
                
                // Create gradient from green to red based on progress
                const startColor = '#10b981'; // Green
                const endColor = '#ef4444';   // Red
                
                // Calculate intermediate color
                const r1 = parseInt(startColor.slice(1, 3), 16);
                const g1 = parseInt(startColor.slice(3, 5), 16);
                const b1 = parseInt(startColor.slice(5, 7), 16);
                
                const r2 = parseInt(endColor.slice(1, 3), 16);
                const g2 = parseInt(endColor.slice(3, 5), 16);
                const b2 = parseInt(endColor.slice(5, 7), 16);
                
                const r = Math.round(r1 + (r2 - r1) * progress);
                const g = Math.round(g1 + (g2 - g1) * progress);
                const b = Math.round(b1 + (b2 - b1) * progress);
                
                const currentColor = `rgb(${r}, ${g}, ${b})`;
                
                sweepEl.style.background = `conic-gradient(from 0deg, ${startColor} 0deg, ${currentColor} ${angle}deg, transparent ${angle}deg)`;
                
                if (progress < 1 && timeLeft > 0) {
                    timerAnimationId = requestAnimationFrame(animateTimer);
                } else {
                    sweepEl.style.background = `conic-gradient(from 0deg, ${startColor} 0deg, ${endColor} 360deg)`;
                    sparkle.classList.add('active');
                    
                    if (timeLeft <= 0) {
                        Swal.fire({
                            icon: 'warning',
                            title: 'Waktu Habis!',
                            text: 'Silakan lanjut ke soal berikutnya',
                            confirmButtonColor: '#f59e0b'
                        });
                    }
                }
            }
            
            timerAnimationId = requestAnimationFrame(animateTimer);
            
            timer = setInterval(() => {
                timeLeft--;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                }
            }, 1000);
        }

        function resetTimerBorder() {
            timerBorder.classList.remove('active');
            sparkle.classList.remove('active');
            sweepEl.style.background = `conic-gradient(from 0deg, #10b981 0deg, #10b981 0deg, transparent 0deg)`;
            if (timerAnimationId) {
                cancelAnimationFrame(timerAnimationId);
                timerAnimationId = null;
            }
            timerStart = null;
        }

        function updateScore(teamId, points) {
            const team = teams.find(t => t.id === teamId);
            team.score = Math.max(0, team.score + points);
            
            // Stop timer when score is updated
            clearInterval(timer);
            resetTimerBorder();
            timeLeft = defaultTime;
            
            generateScoreboard();
            saveGameState();
            
            const action = points > 0 ? 'Benar' : 'Salah';
            const icon = points > 0 ? 'success' : 'error';
            
            Swal.fire({
                icon: icon,
                title: `${action}!`,
                text: `${team.name} ${points > 0 ? '+' : ''}${points} poin`,
                timer: 1500,
                showConfirmButton: false
            });

            // In auto mode, automatically move to next team after scoring
            if (gameMode === 'auto' && !isAutoPaused) {
                setTimeout(() => {
                    currentTeamTurn = (currentTeamTurn + 1) % teams.length;
                    
                    // If we've completed a full round, move to next question
                    if (currentTeamTurn === 0) {
                        changeQuestion(1);
                    } else {
                        startAutoMode();
                    }
                }, 2000); // Wait 2 seconds after scoring
            }
        }

        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function updateQuestionDisplay() {
            if (questions.length > 0) {
                const currentQuestion = questions[currentQuestionIndex];
                
                // Detect text direction
                const textDirection = detectTextDirection(currentQuestion.text);
                questionText.innerHTML = currentQuestion.text;
                questionText.className = `text-3xl leading-relaxed font-medium drop-shadow-lg ${textDirection}`;
                
                currentQuestionNumber.textContent = currentQuestionIndex + 1;
                totalQuestions.textContent = questions.length;
                categoryDisplay.textContent = `Kategori: ${currentQuestion.category}`;
                scoreDisplay.textContent = `Point: ${currentQuestion.score}`;
                
                // Handle image display
                if (currentQuestion.imageUrl && currentQuestion.imageUrl.trim()) {
                    questionImageContainer.classList.remove('hidden');
                    questionImage.src = currentQuestion.imageUrl;
                    questionImage.style.display = 'block';
                    document.getElementById('imageError').style.display = 'none';
                    // Update class to include image layout
                    questionText.className = questionText.className.replace('question-text-only', 'question-with-image');
                } else {
                    questionImageContainer.classList.add('hidden');
                    // Keep the direction class but update layout class
                    questionText.className = questionText.className.replace('question-with-image', 'question-text-only');
                }
                
                // Handle multiple choice display
                if (currentQuestion.type === 'multiple-choice' && currentQuestion.options) {
                    multipleChoiceDisplay.classList.remove('hidden');
                    
                    // Create array of option texts only (without letters)
                    const optionTexts = [
                        currentQuestion.options.A,
                        currentQuestion.options.B,
                        currentQuestion.options.C,
                        currentQuestion.options.D
                    ];
                    
                    // Shuffle only the texts
                    const shuffledTexts = shuffleArray(optionTexts);
                    
                    // Update choice buttons - labels stay A, B, C, D but texts are shuffled
                    const choiceButtons = [choiceA, choiceB, choiceC, choiceD];
                    const displayLabels = ['A', 'B', 'C', 'D'];
                    
                    shuffledTexts.forEach((text, index) => {
                        const button = choiceButtons[index];
                        const letterSpan = button.querySelector('.choice-letter');
                        const textSpan = button.querySelector('.choice-text');
                        
                        // Label stays in order A, B, C, D
                        letterSpan.textContent = displayLabels[index];
                        textSpan.textContent = text;
                        
                        // Find which original letter this text belongs to
                        let originalLetter = 'A';
                        if (text === currentQuestion.options.A) originalLetter = 'A';
                        else if (text === currentQuestion.options.B) originalLetter = 'B';
                        else if (text === currentQuestion.options.C) originalLetter = 'C';
                        else if (text === currentQuestion.options.D) originalLetter = 'D';
                        
                        // Store the original letter for answer checking
                        button.setAttribute('data-original-letter', originalLetter);
                        
                        // Update colors based on position
                        const colors = [
                            { bg: 'bg-blue-600', hover: 'hover:bg-blue-700', letter: 'text-blue-600' },
                            { bg: 'bg-green-600', hover: 'hover:bg-green-700', letter: 'text-green-600' },
                            { bg: 'bg-orange-600', hover: 'hover:bg-orange-700', letter: 'text-orange-600' },
                            { bg: 'bg-purple-600', hover: 'hover:bg-purple-700', letter: 'text-purple-600' }
                        ];
                        
                        const color = colors[index];
                        button.className = `choice-button ${color.bg} ${color.hover} text-white p-4 rounded-lg text-left font-medium transition-all duration-200 transform hover:scale-105 shadow-lg`;
                        letterSpan.className = `choice-letter bg-white ${color.letter} px-3 py-1 rounded-full font-bold mr-3`;
                    });
                } else {
                    multipleChoiceDisplay.classList.add('hidden');
                }
                
                // Update navigation buttons
                prevQuestionBtn.disabled = currentQuestionIndex === 0;
                nextQuestionBtn.disabled = currentQuestionIndex === questions.length - 1;
                
                if (prevQuestionBtn.disabled) {
                    prevQuestionBtn.classList.add('opacity-50', 'cursor-not-allowed');
                } else {
                    prevQuestionBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                }
                
                if (nextQuestionBtn.disabled) {
                    nextQuestionBtn.classList.add('opacity-50', 'cursor-not-allowed');
                } else {
                    nextQuestionBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                }
                
                // Update scoreboard with new question scores
                generateScoreboard();
            }
        }

        function changeQuestion(direction) {
            const newIndex = currentQuestionIndex + direction;
            
            if (newIndex >= 0 && newIndex < questions.length) {
                currentQuestionIndex = newIndex;
                updateQuestionDisplay();
                saveGameState();
                
                // Reset timer and hide answer
                clearInterval(timer);
                resetTimerBorder();
                timeLeft = defaultTime;
                answerDisplay.classList.add('hidden');
                
                // Reset choice button colors when changing questions
                resetChoiceButtonColors();
                
                // In auto mode, restart with first team
                if (gameMode === 'auto') {
                    currentTeamTurn = 0;
                    startAutoMode();
                }
            }
        }

        function resetAllScores() {
            Swal.fire({
                title: 'Reset Semua Skor?',
                text: 'Semua skor tim akan dikembalikan ke 0',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#ef4444',
                cancelButtonColor: '#6b7280',
                confirmButtonText: 'Ya, Reset!',
                cancelButtonText: 'Batal'
            }).then((result) => {
                if (result.isConfirmed) {
                    teams.forEach(team => team.score = 0);
                    generateScoreboard();
                    saveGameState();
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'Berhasil!',
                        text: 'Semua skor telah direset',
                        confirmButtonColor: '#10b981'
                    });
                }
            });
        }

        function showAnswer() {
            if (questions.length > 0 && questions[currentQuestionIndex]) {
                const currentQuestion = questions[currentQuestionIndex];
                let answer = currentQuestion.answer || 'Kunci jawaban tidak tersedia';
                
                // For multiple choice questions, also show the correct option
                if (currentQuestion.type === 'multiple-choice' && currentQuestion.options && currentQuestion.correctAnswer) {
                    const correctOption = currentQuestion.options[currentQuestion.correctAnswer];
                    answer = `<div class="mb-2"><strong>Jawaban: ${currentQuestion.correctAnswer}</strong></div><div>${correctOption}</div>`;
                    if (currentQuestion.answer) {
                        answer += `<div class="mt-2 text-sm text-blue-700">${currentQuestion.answer}</div>`;
                    }
                }
                
                answerText.innerHTML = answer;
                answerDisplay.classList.toggle('hidden');
            }
        }

        function saveGameState() {
            const gameState = {
                teams: teams,
                questions: questions,
                currentQuestionIndex: currentQuestionIndex,
                defaultTime: defaultTime,
                appTitle: appTitle,
                appSubtitle: appSubtitle
            };
            localStorage.setItem('maulidQuizGame', JSON.stringify(gameState));
        }

        function detectTextDirection(text) {
            // Remove HTML tags and extra spaces
            const cleanText = text.replace(/<[^>]*>/g, '').trim();
            
            // Arabic Unicode range: \u0600-\u06FF, \u0750-\u077F, \u08A0-\u08FF, \uFB50-\uFDFF, \uFE70-\uFEFF
            const arabicRegex = /[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/g;
            const latinRegex = /[A-Za-z]/g;
            
            const arabicMatches = cleanText.match(arabicRegex) || [];
            const latinMatches = cleanText.match(latinRegex) || [];
            
            // If there are Arabic characters but no Latin characters, use RTL
            if (arabicMatches.length > 0 && latinMatches.length === 0) {
                return 'arabic-only question-text-only';
            }
            
            // If there are both Arabic and Latin characters, or only Latin, use LTR
            return 'mixed-text question-text-only';
        }

        function loadGameState() {
            const savedState = localStorage.getItem('maulidQuizGame');
            if (savedState) {
                try {
                    const gameState = JSON.parse(savedState);
                    if (gameState.teams && gameState.teams.length > 0) {
                        teams = gameState.teams;
                    }
                    if (gameState.questions && gameState.questions.length > 0) {
                        questions = gameState.questions;
                        updateQuestionPreview();
                    }
                    if (gameState.currentQuestionIndex !== undefined) {
                        currentQuestionIndex = gameState.currentQuestionIndex;
                    }
                    if (gameState.defaultTime) {
                        defaultTime = gameState.defaultTime;
                        defaultTimerInput.value = defaultTime;
                        timeLeft = defaultTime;
                    }
                    if (gameState.appTitle) {
                        appTitle = gameState.appTitle;
                        mainTitleInput.value = appTitle;
                    }
                    if (gameState.appSubtitle !== undefined) {
                        appSubtitle = gameState.appSubtitle;
                        subtitleInput.value = appSubtitle;
                    }
                    // Update header display with loaded values
                    updateHeaderDisplay();
                } catch (error) {
                    console.log('Error loading game state:', error);
                }
            }
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97ced1ab527844b9',t:'MTc1NzUwNjE5My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
